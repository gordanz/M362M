<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Solutions to problems in Chapter 2 | Solutions</title>
  <meta name="description" content="Chapter 2 Solutions to problems in Chapter 2 | Solutions for M362M: Introduction to Stochastic Processes" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Solutions to problems in Chapter 2 | Solutions" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chapter 2 Solutions to problems in Chapter 2 | Solutions for M362M: Introduction to Stochastic Processes" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Solutions to problems in Chapter 2 | Solutions" />
  
  <meta name="twitter:description" content="Chapter 2 Solutions to problems in Chapter 2 | Solutions for M362M: Introduction to Stochastic Processes" />
  

<meta name="author" content="Gordan Zitkovic" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="solutions-to-problems-in-chapter-1.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">M362M Solutions</a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="1" data-path="solutions-to-problems-in-chapter-1.html"><a href="solutions-to-problems-in-chapter-1.html"><i class="fa fa-check"></i><b>1</b> Solutions to problems in Chapter 1</a></li>
<li class="chapter" data-level="2" data-path="solutions-to-problems-in-chapter-2.html"><a href="solutions-to-problems-in-chapter-2.html"><i class="fa fa-check"></i><b>2</b> Solutions to problems in Chapter 2</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Solutions</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="solutions-to-problems-in-chapter-2" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Solutions to problems in Chapter 2</h1>


<div class="exercise">
<p><span id="exr:unnamed-chunk-3" class="exercise"><strong>Problem 2.1  </strong></span><br></p>
<ol style="list-style-type: decimal">
<li><p>Find the Weibull distribution in R’s help system.<!-- ' -->
Simulate <span class="math inline">\(n=10000\)</span> draws from the Weibull distribution with shape parameter <span class="math inline">\(2\)</span> and scale parameter <span class="math inline">\(3\)</span>. Draw a histogram of your simulations.</p></li>
<li><p>Suppose that the vector <code>x</code> contains <span class="math inline">\(n=10000\)</span> simulations from the standard
normal <span class="math inline">\(\mu=0, \sigma=1)\)</span>. Without simulating any new random numbers,
transform it into the vector <code>y</code> such that <code>y</code> is a vector of <span class="math inline">\(n=10000\)</span>
simulations from the normal with <span class="math inline">\(\mu=1\)</span> and <span class="math inline">\(\sigma=0.5\)</span>. Draw histograms
of both <code>x</code> and <code>y</code> on the same plot. (<em>Note:</em> the extra parameter <code>add</code> is
used to superimpose plots. You may want to use different colors, too. Use
the e parameter <code>col</code> for that. )</p></li>
<li><p>Starting with <code>x=seq(-3,3,by=0.1)</code>, define the appropriate vector <code>y</code> and
use <code>x</code> and <code>y</code> to plot the graph of the cdf of the standard normal. The
command you want to use is <code>plot</code> with the following extra arguments</p>
<ul>
<li><code>type="l"</code> (to get a smooth line instead of a bunch of points).</li>
<li><code>main="The CDF of the standard normal"</code> (to set the title), and</li>
<li>another argument (which you must look up youself) that will set the <span class="math inline">\(y\)</span>-axis label to <span class="math inline">\(F(x)\)</span>.
</div></li>
</ul></li>
</ol>
<p>** Solution.**</p>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="solutions-to-problems-in-chapter-2.html#cb1-1"></a>x =<span class="st"> </span><span class="kw">rweibull</span>(<span class="dv">10000</span>, <span class="dt">shape =</span> <span class="dv">2</span>, <span class="dt">scale =</span> <span class="dv">3</span>)</span>
<span id="cb1-2"><a href="solutions-to-problems-in-chapter-2.html#cb1-2"></a><span class="kw">hist</span>(x)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" />
2. let <span class="math inline">\(X\)</span> be a normally distributed random variable, with parameters <span class="math inline">\(\mu_X\)</span> and <span class="math inline">\(\sigma_X\)</span>. When we apply a linear transformation <span class="math inline">\(Y = \alpha X + \beta\)</span> to X, the result <span class="math inline">\(Y\)</span> has a normal distribution again, but with different parameters. These parameters, call them <span class="math inline">\(\mu_Y\)</span> and <span class="math inline">\(\sigma_Y\)</span>, are easily identifies by taking the expected value and the variance:</p>
<p><span class="math display">\[\begin{align} \mu_Y &amp; = {\mathbb{E}}[Y] = \alpha {\mathbb{E}}[X] + \beta = \alpha \mu_X + \beta \\
\sigma_Y^2 &amp; = \operatorname{Var}[Y] = \operatorname{Var}[\alpha X + \beta] = \alpha^2 \operatorname{Var}[X] = \alpha^2 \sigma_X^2 
\end{align}\]</span></p>
<p>In the problem <span class="math inline">\(\mu_X=0\)</span> and <span class="math inline">\(\sigma_X=1\)</span>, so we must take <span class="math inline">\(\alpha = 0.5\)</span> and <span class="math inline">\(\beta=1\)</span> to get <span class="math inline">\(\mu_Y=1\)</span> and <span class="math inline">\(\sigma_Y=0.5\)</span>. In R</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="solutions-to-problems-in-chapter-2.html#cb2-1"></a>x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10000</span>)</span>
<span id="cb2-2"><a href="solutions-to-problems-in-chapter-2.html#cb2-2"></a>y =<span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb2-3"><a href="solutions-to-problems-in-chapter-2.html#cb2-3"></a>(<span class="kw">mean</span>(y))</span>
<span id="cb2-4"><a href="solutions-to-problems-in-chapter-2.html#cb2-4"></a><span class="co">## [1] 0.9967303</span></span>
<span id="cb2-5"><a href="solutions-to-problems-in-chapter-2.html#cb2-5"></a>(<span class="kw">sd</span>(y))</span>
<span id="cb2-6"><a href="solutions-to-problems-in-chapter-2.html#cb2-6"></a><span class="co">## [1] 0.4992758</span></span></code></pre></div>

<div class="exercise">
<p><span id="exr:unnamed-chunk-6" class="exercise"><strong>Problem 2.2  </strong></span><br></p>
<ol style="list-style-type: decimal">
<li><p>Simulate <span class="math inline">\(n=1000\)</span> draws from the distribution whose distribution table is given by</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
<p>2</p>
</th>
<th style="text-align:right;">
<p>4</p>
</th>
<th style="text-align:right;">
<p>8</p>
</th>
<th style="text-align:right;">
<p>16</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
<p>0.2</p>
</td>
<td style="text-align:right;">
<p>0.3</p>
</td>
<td style="text-align:right;">
<p>0.1</p>
</td>
<td style="text-align:right;">
<p>0.4</p>
</td>
</tr>
</tbody>
</table>
<p>and plot their histogram.</p></li>
<li><p>You may have learned in probability how to compute the pdf <span class="math inline">\(f_Y(y)\)</span> of a
transformation <span class="math inline">\(Y=g(X)\)</span> of a random variable with pdf <span class="math inline">\(f_X(x)\)</span>. Suppose
that you forgot how to do that, but have access to <span class="math inline">\(10,000\)</span> simulations from
the distribution of <span class="math inline">\(X\)</span>. How would you get an approximate idea about the
shape of the function <span class="math inline">\(f_Y\)</span>? <br>
More concretely, take <span class="math inline">\(X\)</span> to be exponentially distributed with parameter <span class="math inline">\(1\)</span> and
<span class="math inline">\(g(x) = \sin(x)\)</span> and produce a picture that approximates the pdf <span class="math inline">\(f_Y\)</span> of <span class="math inline">\(Y\)</span>.
(Note: even if you remember how to do this analytically, you will run into a
difficulty. The function <span class="math inline">\(\sin(x)\)</span> is not one-to-one and the method usually
taught in probability classes will not apply. If you learned how to do it in the
many-to-one case of <span class="math inline">\(g(x)= \sin(x)\)</span>, kudos to your instructor!)</p></li>
<li><p>Let <span class="math inline">\(X\)</span> be a random variable with the Cauchy distribution, and <span class="math inline">\(Y = \operatorname{arctan}(X)\)</span>. R allows you to simulate from the Cauchy
distribution, even if you do not know what it is. How would you use that to
make an educated guess as to what the distribution of <span class="math inline">\(Y\)</span> is? To make your
life easier, consider <span class="math inline">\(\tfrac{2}{\pi} Y\)</span> first.</p></li>
</ol>
</div>

<p><strong>Solution.</strong></p>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="solutions-to-problems-in-chapter-2.html#cb3-1"></a>x =<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>), <span class="dt">size =</span> <span class="dv">10000</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.4</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb3-2"><a href="solutions-to-problems-in-chapter-2.html#cb3-2"></a><span class="kw">hist</span>(x)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>We apply the function <span class="math inline">\(\sin\)</span> to the simulations. The histogram of the obtained values is going to be a good (graphical) approximation to the pdf of the transformed random variable:</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="solutions-to-problems-in-chapter-2.html#cb4-1"></a>x =<span class="st"> </span><span class="kw">rexp</span>(<span class="fl">1e+05</span>)</span>
<span id="cb4-2"><a href="solutions-to-problems-in-chapter-2.html#cb4-2"></a>y =<span class="st"> </span><span class="kw">sin</span>(x)</span>
<span id="cb4-3"><a href="solutions-to-problems-in-chapter-2.html#cb4-3"></a><span class="kw">hist</span>(y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-9" class="exercise"><strong>Problem 2.3  </strong></span>A basic method for obtaining simulations draws from distributions other than the
uniform is the <strong>transformation method</strong>. The idea is to start with (pseudo)
random numbers, i.e., draws from the uniform <span class="math inline">\(U(0,1)\)</span> distribution, and then
apply a function <span class="math inline">\(g\)</span> to each simulation. The difficulty is, of course, how to
choose the right function <span class="math inline">\(g\)</span>.
<br>
Let <span class="math inline">\(X\)</span> be a random variable with a continuous and strictly increasing cdf <span class="math inline">\(F\)</span>.
What is the distribution of <span class="math inline">\(Y=F(X)\)</span>? What does that have to do with the transformation method?</p>
(Hint: if you are having difficulty with this problem, feel free to run some experiments using R. )
</div>

<p><strong>Solution.</strong></p>
<p>Let us perform an experimenti where <span class="math inline">\(X \sim N(0,1)\)</span>. Remembering that the cdf is given by the R function <code>pnorm</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="solutions-to-problems-in-chapter-2.html#cb5-1"></a>x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="fl">1e+05</span>)</span>
<span id="cb5-2"><a href="solutions-to-problems-in-chapter-2.html#cb5-2"></a>y =<span class="st"> </span><span class="kw">pnorm</span>(x)</span>
<span id="cb5-3"><a href="solutions-to-problems-in-chapter-2.html#cb5-3"></a><span class="kw">hist</span>(y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;" />
This looks like a histogram of a uniform distribution on <span class="math inline">\((0,1)\)</span>. Let’s try with some other continuous distributions</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="solutions-to-problems-in-chapter-2.html#cb6-1"></a>x1 =<span class="st"> </span><span class="kw">rexp</span>(<span class="fl">1e+05</span>)</span>
<span id="cb6-2"><a href="solutions-to-problems-in-chapter-2.html#cb6-2"></a>x2 =<span class="st"> </span><span class="kw">rcauchy</span>(<span class="fl">1e+05</span>)</span>
<span id="cb6-3"><a href="solutions-to-problems-in-chapter-2.html#cb6-3"></a>x3 =<span class="st"> </span><span class="kw">runif</span>(<span class="fl">1e+05</span>)</span>
<span id="cb6-4"><a href="solutions-to-problems-in-chapter-2.html#cb6-4"></a>x4 =<span class="st"> </span><span class="kw">rgamma</span>(<span class="fl">1e+05</span>, <span class="dt">shape =</span> <span class="dv">3</span>)</span>
<span id="cb6-5"><a href="solutions-to-problems-in-chapter-2.html#cb6-5"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb6-6"><a href="solutions-to-problems-in-chapter-2.html#cb6-6"></a><span class="kw">hist</span>(<span class="kw">pexp</span>(x1))</span>
<span id="cb6-7"><a href="solutions-to-problems-in-chapter-2.html#cb6-7"></a><span class="kw">hist</span>(<span class="kw">pcauchy</span>(x2))</span>
<span id="cb6-8"><a href="solutions-to-problems-in-chapter-2.html#cb6-8"></a><span class="kw">hist</span>(<span class="kw">punif</span>(x3))</span>
<span id="cb6-9"><a href="solutions-to-problems-in-chapter-2.html#cb6-9"></a><span class="kw">hist</span>(<span class="kw">pgamma</span>(x4, <span class="dt">shape =</span> <span class="dv">3</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" />
All of those point to the same conjecture, <span class="math inline">\(F(X)\)</span> is uniformly distributed on <span class="math inline">\((0,1)\)</span>. To prove that, we
take <span class="math inline">\(Y=F(X)\)</span> and try to compute that cdf <span class="math inline">\(F_Y\)</span> of <span class="math inline">\(Y\)</span>:
<span class="math display">\[ F_Y(y) = {\mathbb{P}}[ Y \leq y] = {\mathbb{P}}[ F(X) \leq y]\]</span>
Since <span class="math inline">\(F\)</span> is strictly increasing, it admits an inverse <span class="math inline">\(F^{-1}\)</span>. Moreover, for any <span class="math inline">\(y\)</span>,
the set of all values of <span class="math inline">\(x\)</span> such that <span class="math inline">\(F(x)\leq y\)</span> (the red range) is exactly the interval <span class="math inline">\((-\infty, F^{-1}(y)]\)</span> (the blue range), as in the picture below:</p>
<center>
<img src="cdf_plot.png" width="80%" style="padding:10px" style="display: block; margin: auto;" />
</center>
<p>Hence, <span class="math display">\[F_Y(y)={\mathbb{P}}[Y\leq y] = {\mathbb{P}}[ F(X) \leq y] = {\mathbb{P}}[ X \leq F^{-1}(y) ] = F(F^{-1}(y)) = y \text{ for } y\in (0,1).\]</span> The cdf <span class="math inline">\(F_Y\)</span> is, therefore, equal to the cdf of a uniform on <span class="math inline">\((0,1)\)</span>. Since the cdf uniquely determines the distribution, <span class="math inline">\(Y\)</span> must be uniformly distributed on <span class="math inline">\((0,1)\)</span>.</p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-13" class="exercise"><strong>Problem 2.4  </strong></span>(Extra credit)</p>
<ol style="list-style-type: decimal">
<li><p>Let <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> be two pdfs. We take a constant <span class="math inline">\(\alpha \in (0,1)\)</span> and define the function <span class="math inline">\(f\)</span> by
<span class="math display">\[ f(x) = \alpha f_1(x) + (1-\alpha) f_2(x).\]</span>
The function <span class="math inline">\(f\)</span> is the pdf of a third distribution, which is called the
<strong>mixture of <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> with weights <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(1-\alpha\)</span></strong>.
Assuming that you know how to simulate from the distributions with pdfs <span class="math inline">\(f_1\)</span>
and <span class="math inline">\(f_2\)</span>, how would you draw <span class="math inline">\(10,000\)</span> simulations from the mixture <span class="math inline">\(f\)</span>? Show
your method on the example of a mixture of <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(4,1)\)</span> with
<span class="math inline">\(\alpha=2/3\)</span>. Plot the histogram of the obtained sample (play with the
parameter <code>breaks</code> until you get a nice picture.)</p>
<p>(<em>Hint:</em> start with two vectors, the first containing <span class="math inline">\(10,000\)</span> simulations from
<span class="math inline">\(f_1\)</span> and the second from <span class="math inline">\(f_2\)</span>. Then “toss” <span class="math inline">\(10,000\)</span> biased coins with
<span class="math inline">\(\mathbb{P}[ H ] = \alpha\)</span> … )</p></li>
<li><p>The <strong>double exponential</strong> or
<strong>Laplace</strong> distribution is a continuous probability distribution whose pdf is
given by <span class="math display">\[ \tfrac{1}{2} \exp(-|x|), x\in {\mathbb R}.\]</span> This distribution
is not built into R. How would you produce simulations from the double
exponential using R?</p>
</div></li>
</ol>
<p><strong>Solution.</strong></p>
<ol style="list-style-type: decimal">
<li>The idea is that before each draw a biased coin (with <span class="math inline">\({\mathbb{P}}[H]=\alpha\)</span>) is tossed. If <span class="math inline">\(H\)</span> is obtained, we draw from the distribution with pdf <span class="math inline">\(f_1\)</span>. Otherwise, we draw from the distribution with pdf <span class="math inline">\(f_2\)</span>. Let us first do it using for loops:</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="solutions-to-problems-in-chapter-2.html#cb7-1"></a>nsim =<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb7-2"><a href="solutions-to-problems-in-chapter-2.html#cb7-2"></a>alpha =<span class="st"> </span><span class="dv">2</span><span class="op">/</span><span class="dv">3</span></span>
<span id="cb7-3"><a href="solutions-to-problems-in-chapter-2.html#cb7-3"></a>y =<span class="st"> </span><span class="kw">numeric</span>(nsim)</span>
<span id="cb7-4"><a href="solutions-to-problems-in-chapter-2.html#cb7-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nsim) {</span>
<span id="cb7-5"><a href="solutions-to-problems-in-chapter-2.html#cb7-5"></a>    coin =<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">prob =</span> <span class="kw">c</span>(alpha, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha), <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb7-6"><a href="solutions-to-problems-in-chapter-2.html#cb7-6"></a>    <span class="cf">if</span> (coin <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb7-7"><a href="solutions-to-problems-in-chapter-2.html#cb7-7"></a>        y[i] =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb7-8"><a href="solutions-to-problems-in-chapter-2.html#cb7-8"></a>    } <span class="cf">else</span> {</span>
<span id="cb7-9"><a href="solutions-to-problems-in-chapter-2.html#cb7-9"></a>        y[i] =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">4</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb7-10"><a href="solutions-to-problems-in-chapter-2.html#cb7-10"></a>    }</span>
<span id="cb7-11"><a href="solutions-to-problems-in-chapter-2.html#cb7-11"></a>}</span>
<span id="cb7-12"><a href="solutions-to-problems-in-chapter-2.html#cb7-12"></a><span class="kw">hist</span>(y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;" />
As you can see, the histogram has two “humps”, one centered around <span class="math inline">\(0\)</span> and the other centered around <span class="math inline">\(4\)</span>. The first one is taller, which reflects the higher weight (<span class="math inline">\(\alpha=2/3\)</span>) that <span class="math inline">\(N(0,1)\)</span> has in this mixture.</p>
<p>If you wanted to write a more succinct code (but not necessarily faster in this case), you could also do something like this</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="solutions-to-problems-in-chapter-2.html#cb8-1"></a>nsim =<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb8-2"><a href="solutions-to-problems-in-chapter-2.html#cb8-2"></a>alpha =<span class="st"> </span><span class="dv">2</span><span class="op">/</span><span class="dv">3</span></span>
<span id="cb8-3"><a href="solutions-to-problems-in-chapter-2.html#cb8-3"></a>x1 =<span class="st"> </span><span class="kw">rnorm</span>(nsim)</span>
<span id="cb8-4"><a href="solutions-to-problems-in-chapter-2.html#cb8-4"></a>x2 =<span class="st"> </span><span class="kw">rnorm</span>(nsim, <span class="dt">mean =</span> <span class="dv">4</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb8-5"><a href="solutions-to-problems-in-chapter-2.html#cb8-5"></a>coin =<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>), <span class="dt">size =</span> nsim, <span class="dt">prob =</span> <span class="kw">c</span>(alpha, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha), <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb8-6"><a href="solutions-to-problems-in-chapter-2.html#cb8-6"></a>y =<span class="st"> </span><span class="kw">ifelse</span>(coin, x1, x2)</span></code></pre></div>
<p>The function <code>ifelse</code> takes three arguments of equal lengths. The first one is a vector of logical values <code>c</code>, and the other two, <code>x1, x2</code> only need to be of the same type. The result of is a vector whose value at the position <code>i</code> is <code>x1[i]</code> if <code>c[i]==TRUE</code> and <code>x2[i]</code> otherwise.</p>
<ol start="2" style="list-style-type: decimal">
<li>The Laplace distribution can be understood as a mixture, with <span class="math inline">\(\alpha=1/2\)</span> of two distributions. The first one is an exponential, and the second one is the exponential, but with the negative sign.
Using our strategy from part 1. above, we could get simulations of it as follows:</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="solutions-to-problems-in-chapter-2.html#cb9-1"></a>nsim =<span class="st"> </span><span class="fl">1e+05</span></span>
<span id="cb9-2"><a href="solutions-to-problems-in-chapter-2.html#cb9-2"></a>alpha =<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span></span>
<span id="cb9-3"><a href="solutions-to-problems-in-chapter-2.html#cb9-3"></a>x1 =<span class="st"> </span><span class="kw">rexp</span>(nsim)</span>
<span id="cb9-4"><a href="solutions-to-problems-in-chapter-2.html#cb9-4"></a>x2 =<span class="st"> </span><span class="op">-</span><span class="kw">rexp</span>(nsim)  <span class="co"># note the minus in front of rexp</span></span>
<span id="cb9-5"><a href="solutions-to-problems-in-chapter-2.html#cb9-5"></a>coin =<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>), <span class="dt">size =</span> nsim, <span class="dt">prob =</span> <span class="kw">c</span>(alpha, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha), <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-6"><a href="solutions-to-problems-in-chapter-2.html#cb9-6"></a>y =<span class="st"> </span><span class="kw">ifelse</span>(coin, x1, x2)</span>
<span id="cb9-7"><a href="solutions-to-problems-in-chapter-2.html#cb9-7"></a><span class="kw">hist</span>(y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;" />
You can do this more efficiently if you realize that every time we toss a coin and choose between <code>x1</code> and <code>x2</code>, we are really choosing the sign in front of an exponentially distributed random variable. In other words, we can use <code>coin</code> as
a vector of random signs for a vector or draws from the exponential distribution:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="solutions-to-problems-in-chapter-2.html#cb10-1"></a>nsim =<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb10-2"><a href="solutions-to-problems-in-chapter-2.html#cb10-2"></a>alpha =<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span></span>
<span id="cb10-3"><a href="solutions-to-problems-in-chapter-2.html#cb10-3"></a>x =<span class="st"> </span><span class="kw">rexp</span>(nsim)</span>
<span id="cb10-4"><a href="solutions-to-problems-in-chapter-2.html#cb10-4"></a>coin =<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">size =</span> nsim, <span class="dt">prob =</span> <span class="kw">c</span>(alpha, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha), <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb10-5"><a href="solutions-to-problems-in-chapter-2.html#cb10-5"></a>y =<span class="st"> </span>coin <span class="op">*</span><span class="st"> </span>x</span>
<span id="cb10-6"><a href="solutions-to-problems-in-chapter-2.html#cb10-6"></a><span class="kw">hist</span>(y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;" /></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-18" class="exercise"><strong>Problem 2.5  </strong></span>Let <code>x=rnorm(1000)</code> and <code>y=rnorm(1000)</code>. For each of the following pairs, use the permutation test to decide whether they are independent or not</p>
<ol style="list-style-type: lower-alpha">
<li><code>x^2+y^2</code> and <code>y^2</code></li>
<li><code>(x+y)/sqrt(2)</code> and <code>(x-y)/sqrt(2)</code></li>
<li><code>x</code> and <code>1</code></li>
<li><code>x^2+y^2</code> and <code>atan(y/x)</code>.</li>
</ol>
<p>What your conclusions in b. and d. suggest about the geometric properties of the distribution of <span class="math inline">\((X,Y)\)</span> where <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent with standard normal distributions?</p>
(Note: do not worry about dividing by <span class="math inline">\(0\)</span> in d. It will happen with probability <span class="math inline">\(0\)</span>.)
</div>

<p><strong>Solution.</strong> Let us write a function to save some keystrokes</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="solutions-to-problems-in-chapter-2.html#cb11-1"></a>permutation_test =<span class="st"> </span><span class="cf">function</span>(z, w) {</span>
<span id="cb11-2"><a href="solutions-to-problems-in-chapter-2.html#cb11-2"></a>    <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb11-3"><a href="solutions-to-problems-in-chapter-2.html#cb11-3"></a>    <span class="kw">plot</span>(z, w, <span class="dt">asp =</span> <span class="dv">1</span>)</span>
<span id="cb11-4"><a href="solutions-to-problems-in-chapter-2.html#cb11-4"></a>    <span class="kw">plot</span>(z, <span class="kw">sample</span>(w), <span class="dt">asp =</span> <span class="dv">1</span>)</span>
<span id="cb11-5"><a href="solutions-to-problems-in-chapter-2.html#cb11-5"></a>    <span class="kw">plot</span>(z, <span class="kw">sample</span>(w), <span class="dt">asp =</span> <span class="dv">1</span>)</span>
<span id="cb11-6"><a href="solutions-to-problems-in-chapter-2.html#cb11-6"></a>    <span class="kw">plot</span>(z, <span class="kw">sample</span>(w), <span class="dt">asp =</span> <span class="dv">1</span>)</span>
<span id="cb11-7"><a href="solutions-to-problems-in-chapter-2.html#cb11-7"></a>}</span>
<span id="cb11-8"><a href="solutions-to-problems-in-chapter-2.html#cb11-8"></a></span>
<span id="cb11-9"><a href="solutions-to-problems-in-chapter-2.html#cb11-9"></a>x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb11-10"><a href="solutions-to-problems-in-chapter-2.html#cb11-10"></a>y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="solutions-to-problems-in-chapter-2.html#cb12-1"></a><span class="kw">permutation_test</span>(x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>y<span class="op">^</span><span class="dv">2</span>, y<span class="op">^</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-20-1.png" width="768" style="display: block; margin: auto;" />
The first plot is very different from the other three. Therefore,the vectors are probably <em>not</em> independent.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="solutions-to-problems-in-chapter-2.html#cb13-1"></a><span class="kw">permutation_test</span>((x <span class="op">+</span><span class="st"> </span>y)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span>), (x <span class="op">-</span><span class="st"> </span>y)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-21-1.png" width="768" style="display: block; margin: auto;" />
The first plot could easily be confused for one of the other three. Therefore the vectors are probably independent.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="solutions-to-problems-in-chapter-2.html#cb14-1"></a><span class="co"># we have to use rep(1,length(x)) to get a vector of 1s of the same length as x</span></span>
<span id="cb14-2"><a href="solutions-to-problems-in-chapter-2.html#cb14-2"></a><span class="kw">permutation_test</span>(x, <span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">length</span>(x)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-22-1.png" width="768" style="display: block; margin: auto;" />
The plots look very similar. Therefore, the vectors are probably independent. We could have known this without drawing any graphs. Anything is independent of a constant random variable (vector).</p>
<ol start="4" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="solutions-to-problems-in-chapter-2.html#cb15-1"></a><span class="kw">permutation_test</span>(x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>y<span class="op">^</span><span class="dv">2</span>, <span class="kw">atan</span>(y<span class="op">/</span>x))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-23-1.png" width="768" style="display: block; margin: auto;" />
Plots look very similar to each other. Therefore, <code>z</code> and <code>w</code> are probably independent.</p>
<p>These plots in b) and d) revealed that the distribution of the random vector <span class="math inline">\((X,Y)\)</span> consisting of two independent standard normals is probably rotation invariant. In b) we are asked to compare the coordinates of the vector obtained from <span class="math inline">\((X,Y)\)</span> by a rotation at <span class="math inline">\(45\)</span> degrees around the origin. The fact that independence persisted suggests that components remain independent even after a (specific) rotation. If you tried rotations by different angles you would get the same result. The experiment in d) told us that the (squared) distance <span class="math inline">\(X^2+Y^2\)</span> and angle between <span class="math inline">\((X,Y)\)</span> and the <span class="math inline">\(x\)</span>-are independent. This is also something that one would expect from a rotationally-invariant distribution. Indeed, the distribution of the distance to the origin should not depend on the direction.</p>
<p>It is important to note that none of this proves anything. It is simply numerical evidence for a given conclusion.</p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-24" class="exercise"><strong>Problem 2.6  </strong></span>Simulate <span class="math inline">\(n=10000\)</span> draws from the joint distribution given by the following
table:</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;text-align: center;">
</th>
<th style="text-align:right;text-align: center;">
1
</th>
<th style="text-align:right;text-align: center;">
2
</th>
<th style="text-align:right;text-align: center;">
3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
1
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.3
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
3
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.4
</td>
</tr>
</tbody>
</table>
Display the contingency table of your results, as well as a table showing the “errors”, i.e., differences between the theoretical frequencies (i.e., probabilities given above) and the obtained relative frequencies in the sample.
</div>

<p><strong>Solution.</strong></p>
<p>We are using the same procedure as in the Section 2.2 in the notes.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="solutions-to-problems-in-chapter-2.html#cb16-1"></a>nsim =<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb16-2"><a href="solutions-to-problems-in-chapter-2.html#cb16-2"></a></span>
<span id="cb16-3"><a href="solutions-to-problems-in-chapter-2.html#cb16-3"></a>joint_distribution_long =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, </span>
<span id="cb16-4"><a href="solutions-to-problems-in-chapter-2.html#cb16-4"></a>    <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb16-5"><a href="solutions-to-problems-in-chapter-2.html#cb16-5"></a>probabilities_long =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">0</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.4</span>)</span>
<span id="cb16-6"><a href="solutions-to-problems-in-chapter-2.html#cb16-6"></a></span>
<span id="cb16-7"><a href="solutions-to-problems-in-chapter-2.html#cb16-7"></a>sampled_rows =<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(joint_distribution_long), <span class="dt">size =</span> nsim, <span class="dt">replace =</span> <span class="ot">TRUE</span>, </span>
<span id="cb16-8"><a href="solutions-to-problems-in-chapter-2.html#cb16-8"></a>    <span class="dt">prob =</span> probabilities_long)</span>
<span id="cb16-9"><a href="solutions-to-problems-in-chapter-2.html#cb16-9"></a></span>
<span id="cb16-10"><a href="solutions-to-problems-in-chapter-2.html#cb16-10"></a>draws =<span class="st"> </span>joint_distribution_long[sampled_rows, ]</span>
<span id="cb16-11"><a href="solutions-to-problems-in-chapter-2.html#cb16-11"></a></span>
<span id="cb16-12"><a href="solutions-to-problems-in-chapter-2.html#cb16-12"></a>(<span class="dt">freq =</span> <span class="kw">table</span>(draws))</span>
<span id="cb16-13"><a href="solutions-to-problems-in-chapter-2.html#cb16-13"></a><span class="co">##    y</span></span>
<span id="cb16-14"><a href="solutions-to-problems-in-chapter-2.html#cb16-14"></a><span class="co">## x      1    2    3</span></span>
<span id="cb16-15"><a href="solutions-to-problems-in-chapter-2.html#cb16-15"></a><span class="co">##   1  970    0 3032</span></span>
<span id="cb16-16"><a href="solutions-to-problems-in-chapter-2.html#cb16-16"></a><span class="co">##   2 1014 1023    0</span></span>
<span id="cb16-17"><a href="solutions-to-problems-in-chapter-2.html#cb16-17"></a><span class="co">##   3    0    0 3961</span></span>
<span id="cb16-18"><a href="solutions-to-problems-in-chapter-2.html#cb16-18"></a></span>
<span id="cb16-19"><a href="solutions-to-problems-in-chapter-2.html#cb16-19"></a>(<span class="dt">rel_freq =</span> <span class="kw">table</span>(draws)<span class="op">/</span>nsim)</span>
<span id="cb16-20"><a href="solutions-to-problems-in-chapter-2.html#cb16-20"></a><span class="co">##    y</span></span>
<span id="cb16-21"><a href="solutions-to-problems-in-chapter-2.html#cb16-21"></a><span class="co">## x        1      2      3</span></span>
<span id="cb16-22"><a href="solutions-to-problems-in-chapter-2.html#cb16-22"></a><span class="co">##   1 0.0970 0.0000 0.3032</span></span>
<span id="cb16-23"><a href="solutions-to-problems-in-chapter-2.html#cb16-23"></a><span class="co">##   2 0.1014 0.1023 0.0000</span></span>
<span id="cb16-24"><a href="solutions-to-problems-in-chapter-2.html#cb16-24"></a><span class="co">##   3 0.0000 0.0000 0.3961</span></span>
<span id="cb16-25"><a href="solutions-to-problems-in-chapter-2.html#cb16-25"></a></span>
<span id="cb16-26"><a href="solutions-to-problems-in-chapter-2.html#cb16-26"></a>(<span class="dt">th_freq =</span> <span class="kw">matrix</span>(probabilities_long, <span class="dt">byrow =</span> <span class="ot">TRUE</span>, <span class="dt">nrow =</span> <span class="dv">3</span>))</span>
<span id="cb16-27"><a href="solutions-to-problems-in-chapter-2.html#cb16-27"></a><span class="co">##      [,1] [,2] [,3]</span></span>
<span id="cb16-28"><a href="solutions-to-problems-in-chapter-2.html#cb16-28"></a><span class="co">## [1,]  0.1  0.0  0.3</span></span>
<span id="cb16-29"><a href="solutions-to-problems-in-chapter-2.html#cb16-29"></a><span class="co">## [2,]  0.1  0.1  0.0</span></span>
<span id="cb16-30"><a href="solutions-to-problems-in-chapter-2.html#cb16-30"></a><span class="co">## [3,]  0.0  0.0  0.4</span></span>
<span id="cb16-31"><a href="solutions-to-problems-in-chapter-2.html#cb16-31"></a></span>
<span id="cb16-32"><a href="solutions-to-problems-in-chapter-2.html#cb16-32"></a>(<span class="dt">err =</span> rel_freq <span class="op">-</span><span class="st"> </span>th_freq)</span>
<span id="cb16-33"><a href="solutions-to-problems-in-chapter-2.html#cb16-33"></a><span class="co">##    y</span></span>
<span id="cb16-34"><a href="solutions-to-problems-in-chapter-2.html#cb16-34"></a><span class="co">## x         1       2       3</span></span>
<span id="cb16-35"><a href="solutions-to-problems-in-chapter-2.html#cb16-35"></a><span class="co">##   1 -0.0030  0.0000  0.0032</span></span>
<span id="cb16-36"><a href="solutions-to-problems-in-chapter-2.html#cb16-36"></a><span class="co">##   2  0.0014  0.0023  0.0000</span></span>
<span id="cb16-37"><a href="solutions-to-problems-in-chapter-2.html#cb16-37"></a><span class="co">##   3  0.0000  0.0000 -0.0039</span></span></code></pre></div>

<div class="exercise">
<p><span id="exr:unnamed-chunk-26" class="exercise"><strong>Problem 2.7  </strong></span>Estimate the following integrals using Monte Carlo</p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math inline">\(\int_0^1 \cos(x)\, dx\)</span></p></li>
<li><p><span class="math inline">\(\int_{-\infty}^{\infty}\frac{1}{\sqrt{2\pi}}\frac{e^{-x^2/2}}{1+x^4}\,dx\)</span></p></li>
<li><p><span class="math inline">\(\int_0^{\infty} e^{-x^3-x}\, dx\)</span></p></li>
<li><p><span class="math inline">\(\int_{-\infty}^{\infty} \frac{\cos(x^2)}{1+x^2}\, dx\)</span> (extra credit)</p></li>
</ol>
</div>

<p><strong>Solution.</strong></p>
<p>The idea here is to use the “fundamental theorem of statistics”
<span class="math display">\[ {\mathbb{E}}[ g(X) ] = \int g(x)\, f_X(x)\, dx \]</span>
where <span class="math inline">\(f_X\)</span> is the pdf of <span class="math inline">\(X\)</span> and <span class="math inline">\(g\)</span> is any reasonably well-behaved function.
Normally, one would use the integral on the right to compute the expectation
on the left. We are flipping the logic, and using the expectation
(which we can approximate via Monte Carlo) to estimate the integral on the
right.</p>
<ol style="list-style-type: lower-alpha">
<li>We pick <span class="math inline">\(g(x) = \cos(x)\)</span> and <span class="math inline">\(X\)</span> a r.v. with a uniform distribution on <span class="math inline">\((0,1)\)</span>, so that <span class="math inline">\(f_X(x) = 1\)</span> for <span class="math inline">\(x\in (0,1)\)</span> and <span class="math inline">\(0\)</span> otherwise:</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="solutions-to-problems-in-chapter-2.html#cb17-1"></a>nsim =<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb17-2"><a href="solutions-to-problems-in-chapter-2.html#cb17-2"></a>x =<span class="st"> </span><span class="kw">runif</span>(nsim)</span>
<span id="cb17-3"><a href="solutions-to-problems-in-chapter-2.html#cb17-3"></a>y =<span class="st"> </span><span class="kw">cos</span>(x)</span>
<span id="cb17-4"><a href="solutions-to-problems-in-chapter-2.html#cb17-4"></a><span class="kw">mean</span>(y)</span>
<span id="cb17-5"><a href="solutions-to-problems-in-chapter-2.html#cb17-5"></a><span class="co">## [1] 0.8399541</span></span></code></pre></div>
<p>For comparison, the exact value of the integral is <span class="math inline">\(\sin(1) \approx 0.841471\)</span>.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>We cannot use the uniform distribution anymore, because the limits of integration are <span class="math inline">\(\pm \infty\)</span>. Part of the expression inside the integral can be recognized as a (standard) normal density, so we take <span class="math inline">\(X \sim N(0,1)\)</span> and <span class="math inline">\(g(x) = 1/(1+x^4)\)</span></li>
</ol>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="solutions-to-problems-in-chapter-2.html#cb18-1"></a>nsim =<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb18-2"><a href="solutions-to-problems-in-chapter-2.html#cb18-2"></a>x =<span class="st"> </span><span class="kw">rnorm</span>(nsim)</span>
<span id="cb18-3"><a href="solutions-to-problems-in-chapter-2.html#cb18-3"></a>y =<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">4</span>)</span>
<span id="cb18-4"><a href="solutions-to-problems-in-chapter-2.html#cb18-4"></a><span class="kw">mean</span>(y)</span>
<span id="cb18-5"><a href="solutions-to-problems-in-chapter-2.html#cb18-5"></a><span class="co">## [1] 0.6774491</span></span></code></pre></div>
<p>The “exact” value (i.e., very precise approximation to this integral obtained using another numerical method) is <span class="math inline">\(0.676763\)</span>.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>We integrate <span class="math inline">\(g(x) = \exp(-x^3)\)</span> against the exponential pdf <span class="math inline">\(f_X(x) = \exp(-x)\)</span>, for <span class="math inline">\(x&gt;0\)</span>:</li>
</ol>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="solutions-to-problems-in-chapter-2.html#cb19-1"></a>nsim =<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb19-2"><a href="solutions-to-problems-in-chapter-2.html#cb19-2"></a>x =<span class="st"> </span><span class="kw">rexp</span>(nsim)</span>
<span id="cb19-3"><a href="solutions-to-problems-in-chapter-2.html#cb19-3"></a>y =<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb19-4"><a href="solutions-to-problems-in-chapter-2.html#cb19-4"></a><span class="kw">mean</span>(y)</span>
<span id="cb19-5"><a href="solutions-to-problems-in-chapter-2.html#cb19-5"></a><span class="co">## [1] 0.5715195</span></span></code></pre></div>
<p>A close approximation of the true value is <span class="math inline">\(0.56889\)</span>.</p>
<p>d). In this case, a possible choice of the distribution for <span class="math inline">\(X\)</span> is the Cauchy distribution (no worries if you never heard about it), whose pdf is <span class="math inline">\(f_X(x) = \frac{1}{\pi(1+x^2)}\)</span>, so that <span class="math inline">\(g(x) = \pi \cos(x^2)\)</span>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="solutions-to-problems-in-chapter-2.html#cb20-1"></a>nsim =<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb20-2"><a href="solutions-to-problems-in-chapter-2.html#cb20-2"></a>x =<span class="st"> </span><span class="kw">rcauchy</span>(nsim)</span>
<span id="cb20-3"><a href="solutions-to-problems-in-chapter-2.html#cb20-3"></a>y =<span class="st"> </span>pi <span class="op">*</span><span class="st"> </span><span class="kw">cos</span>(x<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb20-4"><a href="solutions-to-problems-in-chapter-2.html#cb20-4"></a><span class="kw">mean</span>(y)</span>
<span id="cb20-5"><a href="solutions-to-problems-in-chapter-2.html#cb20-5"></a><span class="co">## [1] 1.308776</span></span></code></pre></div>
<p>The “exact” value is <span class="math inline">\(1.30561\)</span>.</p>

<div class="exercise">
<span id="exr:unnamed-chunk-31" class="exercise"><strong>Problem 2.8  </strong></span>The <strong>tricylinder</strong> is a solid body constructed as follows: create three cylinders of radius 1 around each of the three coordinate axes and intersect them:
<figure style="
    display: flex;
    flex-flow: column;
    padding: 5px;
    margin: auto;">
<img src="tricylinder.png" style="border-bottom: -10px;"></img>
<figcaption style=" 
    background-color: #fff;
    color: #000;
    font: italic smaller sans-serif;
    padding: 3px;
    text-align: center;">
Image by Ag2gaeh - Own work, CC BY-SA 4.0, <a href="https://commons.wikimedia.org/w/index.php?curid=63604565" class="uri">https://commons.wikimedia.org/w/index.php?curid=63604565</a>
</figcaption>
</figure>
Use Monte Carlo to estimate the volume of the tricylinder and
check your estimate against the exact value <span class="math inline">\(8(2-\sqrt{2})\)</span>.
</div>

<p><strong>Solution.</strong></p>
<p>By the very construction, it is clear that the entire tricylinder lies within the cube <span class="math inline">\([-1,1]\times [-1,1] \times [-1,1]\)</span>. Therefore, we can compute its volume by simulating random draws from the uniform distribution in that cube, and
computing the relative frequence of those values that fall inside the tricylinder. The whole point is that it is easy to check, given a point <span class="math inline">\((x,y,z)\)</span> whether it lies inside the tricylinder or not. Indeed, the answer is “yes” if and only if all three of the following inequalities are satisfied:
<span class="math display">\[ x^2+y^2 \le 1,\  x^2+z^2\leq 1 \text{ and } y^2+z^2\leq 1.\]</span></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="solutions-to-problems-in-chapter-2.html#cb21-1"></a>nsim =<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb21-2"><a href="solutions-to-problems-in-chapter-2.html#cb21-2"></a>x =<span class="st"> </span><span class="kw">runif</span>(nsim, <span class="dt">min =</span> <span class="dv">-1</span>, <span class="dt">max =</span> <span class="dv">1</span>)</span>
<span id="cb21-3"><a href="solutions-to-problems-in-chapter-2.html#cb21-3"></a>y =<span class="st"> </span><span class="kw">runif</span>(nsim, <span class="dt">min =</span> <span class="dv">-1</span>, <span class="dt">max =</span> <span class="dv">1</span>)</span>
<span id="cb21-4"><a href="solutions-to-problems-in-chapter-2.html#cb21-4"></a>z =<span class="st"> </span><span class="kw">runif</span>(nsim, <span class="dt">min =</span> <span class="dv">-1</span>, <span class="dt">max =</span> <span class="dv">1</span>)</span>
<span id="cb21-5"><a href="solutions-to-problems-in-chapter-2.html#cb21-5"></a>is_in =<span class="st"> </span>(x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>y<span class="op">^</span><span class="dv">2</span> <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&amp;</span><span class="st"> </span>(x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>z<span class="op">^</span><span class="dv">2</span> <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&amp;</span><span class="st"> </span>(y<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>z<span class="op">^</span><span class="dv">2</span> <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb21-6"><a href="solutions-to-problems-in-chapter-2.html#cb21-6"></a>(<span class="dv">2</span><span class="op">^</span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(is_in)<span class="op">/</span>nsim)</span>
<span id="cb21-7"><a href="solutions-to-problems-in-chapter-2.html#cb21-7"></a><span class="co">## [1] 4.7376</span></span></code></pre></div>
<p>We multiplied by <span class="math inline">\(2^3\)</span> because that is the volume of the cube <span class="math inline">\([-1,1]\times [-1,1] \times [-1,1]\)</span>. Without it, we would get the portion of the cube taken by the tricylinder, and not its volume.</p>
The true value of <span class="math inline">\(8(2-\sqrt{2})\)</span> is, approximately, <span class="math inline">\(4.6862\)</span>.

<div class="exercise">
<span id="exr:unnamed-chunk-33" class="exercise"><strong>Problem 2.9  </strong></span>Read about the Monty Hall Problem online (the introduction to its <a href="https://en.wikipedia.org/wiki/Monty_Hall_problem">Wikipedia page</a> has a nice description),
Use Monte Carlo to compare the two possible strategies (switching and not-switching) and decide which is better.
</div>

<p><strong>Solution.</strong></p>
<p>The host knows where the car is and what contestant’s guess is. If those two are the same (i.e., contestant guessed right), he will choose one of the two remaining doors at random. If not, he simply shows the contestant the other door with the goat behind it. This exactly what the function <code>show_door</code> implements:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="solutions-to-problems-in-chapter-2.html#cb22-1"></a>show_door =<span class="st"> </span><span class="cf">function</span>(car, guess) {</span>
<span id="cb22-2"><a href="solutions-to-problems-in-chapter-2.html#cb22-2"></a>    all_doors =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb22-3"><a href="solutions-to-problems-in-chapter-2.html#cb22-3"></a>    goat_doors =<span class="st"> </span>all_doors[all_doors <span class="op">!=</span><span class="st"> </span>car]</span>
<span id="cb22-4"><a href="solutions-to-problems-in-chapter-2.html#cb22-4"></a>    </span>
<span id="cb22-5"><a href="solutions-to-problems-in-chapter-2.html#cb22-5"></a>    <span class="cf">if</span> (car <span class="op">==</span><span class="st"> </span>guess) {</span>
<span id="cb22-6"><a href="solutions-to-problems-in-chapter-2.html#cb22-6"></a>        random_goat_door =<span class="st"> </span><span class="kw">sample</span>(goat_doors, <span class="dt">size =</span> <span class="dv">1</span>)</span>
<span id="cb22-7"><a href="solutions-to-problems-in-chapter-2.html#cb22-7"></a>        <span class="kw">return</span>(random_goat_door)</span>
<span id="cb22-8"><a href="solutions-to-problems-in-chapter-2.html#cb22-8"></a>    } <span class="cf">else</span> {</span>
<span id="cb22-9"><a href="solutions-to-problems-in-chapter-2.html#cb22-9"></a>        unpicked_goat_door =<span class="st"> </span>goat_doors[goat_doors <span class="op">!=</span><span class="st"> </span>guess]</span>
<span id="cb22-10"><a href="solutions-to-problems-in-chapter-2.html#cb22-10"></a>        <span class="kw">return</span>(unpicked_goat_door)</span>
<span id="cb22-11"><a href="solutions-to-problems-in-chapter-2.html#cb22-11"></a>    }</span>
<span id="cb22-12"><a href="solutions-to-problems-in-chapter-2.html#cb22-12"></a>}</span></code></pre></div>
<p>Next, we write a function which simulates the outcome of a single game. It will have one argument, <code>switch</code> which will determine whether the contestant switches to door or not.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="solutions-to-problems-in-chapter-2.html#cb23-1"></a>one_game =<span class="st"> </span><span class="cf">function</span>(<span class="cf">switch</span>) {</span>
<span id="cb23-2"><a href="solutions-to-problems-in-chapter-2.html#cb23-2"></a>    all_doors =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb23-3"><a href="solutions-to-problems-in-chapter-2.html#cb23-3"></a>    car =<span class="st"> </span><span class="kw">sample</span>(all_doors, <span class="dt">size =</span> <span class="dv">1</span>)</span>
<span id="cb23-4"><a href="solutions-to-problems-in-chapter-2.html#cb23-4"></a>    guess =<span class="st"> </span><span class="kw">sample</span>(all_doors, <span class="dt">size =</span> <span class="dv">1</span>)</span>
<span id="cb23-5"><a href="solutions-to-problems-in-chapter-2.html#cb23-5"></a>    </span>
<span id="cb23-6"><a href="solutions-to-problems-in-chapter-2.html#cb23-6"></a>    <span class="cf">if</span> (<span class="cf">switch</span>) {</span>
<span id="cb23-7"><a href="solutions-to-problems-in-chapter-2.html#cb23-7"></a>        unguessed_doors =<span class="st"> </span>all_doors[all_doors <span class="op">!=</span><span class="st"> </span>guess]</span>
<span id="cb23-8"><a href="solutions-to-problems-in-chapter-2.html#cb23-8"></a>        shown_door =<span class="st"> </span><span class="kw">show_door</span>(car, guess)</span>
<span id="cb23-9"><a href="solutions-to-problems-in-chapter-2.html#cb23-9"></a>        switched_guess =<span class="st"> </span>unguessed_doors[unguessed_doors <span class="op">!=</span><span class="st"> </span>shown_door]</span>
<span id="cb23-10"><a href="solutions-to-problems-in-chapter-2.html#cb23-10"></a>        <span class="kw">return</span>(switched_guess <span class="op">==</span><span class="st"> </span>car)</span>
<span id="cb23-11"><a href="solutions-to-problems-in-chapter-2.html#cb23-11"></a>    } <span class="cf">else</span> {</span>
<span id="cb23-12"><a href="solutions-to-problems-in-chapter-2.html#cb23-12"></a>        <span class="kw">return</span>(guess <span class="op">==</span><span class="st"> </span>car)</span>
<span id="cb23-13"><a href="solutions-to-problems-in-chapter-2.html#cb23-13"></a>    }</span>
<span id="cb23-14"><a href="solutions-to-problems-in-chapter-2.html#cb23-14"></a>}</span></code></pre></div>
<p>Finally we run two batches of <span class="math inline">\(10,000\)</span> simulations, one with <code>switch=TRUE</code> and another with <code>switch=FALSE</code>. We use the command <code>replicate</code> to call a function several times and to store the results in the vector</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="solutions-to-problems-in-chapter-2.html#cb24-1"></a>nsim =<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb24-2"><a href="solutions-to-problems-in-chapter-2.html#cb24-2"></a>switch_doors =<span class="st"> </span><span class="kw">replicate</span>(nsim, <span class="kw">one_game</span>(<span class="ot">TRUE</span>))</span>
<span id="cb24-3"><a href="solutions-to-problems-in-chapter-2.html#cb24-3"></a>dont_switch_doors =<span class="st"> </span><span class="kw">replicate</span>(nsim, <span class="kw">one_game</span>(<span class="ot">FALSE</span>))</span>
<span id="cb24-4"><a href="solutions-to-problems-in-chapter-2.html#cb24-4"></a>(<span class="dt">prob_with_switching =</span> <span class="kw">mean</span>(switch_doors))</span>
<span id="cb24-5"><a href="solutions-to-problems-in-chapter-2.html#cb24-5"></a><span class="co">## [1] 0.6679</span></span>
<span id="cb24-6"><a href="solutions-to-problems-in-chapter-2.html#cb24-6"></a>(<span class="dt">prob_without_switching =</span> <span class="kw">mean</span>(dont_switch_doors))</span>
<span id="cb24-7"><a href="solutions-to-problems-in-chapter-2.html#cb24-7"></a><span class="co">## [1] 0.3312</span></span></code></pre></div>
<p>Therefore, the probability of winning after switching is about double the probability of winning without switching. Switching is good for you!</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="solutions-to-problems-in-chapter-1.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": false,
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
