<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="2.1 How to simulate some common probability distributions | Lecture notes for &quot;Introduction to Stochastic Processes&quot;" />
<meta property="og:type" content="book" />


<meta property="og:description" content="A set of lecture notes for M362M: Introduction to Stochastic Processes" />
<meta name="github-repo" content="gordanz/M362M" />

<meta name="author" content="Gordan Zitkovic" />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="A set of lecture notes for M362M: Introduction to Stochastic Processes">

<title>2.1 How to simulate some common probability distributions | Lecture notes for &quot;Introduction to Stochastic Processes&quot;</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#preface">Preface</a></li>
<li class="has-sub"><a href="1-intro.html#intro"><span class="toc-section-number">1</span> An intro to R and RStudio</a><ul>
<li><a href="1-1-setting-up-an-r-environment-on-your-computer.html#setting-up-an-r-environment-on-your-computer"><span class="toc-section-number">1.1</span> Setting up an R environment on your computer</a></li>
<li><a href="1-2-learning-the-very-basics-of-r.html#learning-the-very-basics-of-r"><span class="toc-section-number">1.2</span> Learning the very basics of R</a></li>
<li><a href="1-3-r-notebooks-or-how-to-submit-your-hw-assignments-and-exams.html#r-notebooks-or-how-to-submit-your-hw-assignments-and-exams"><span class="toc-section-number">1.3</span> R Notebooks or <em>How to submit your HW assignments and exams</em></a></li>
<li><a href="1-4-problems.html#problems"><span class="toc-section-number">1.4</span> Problems</a></li>
</ul></li>
<li class="part"><span><b>I Probability and Simulation</b></span></li>
<li class="has-sub"><a href="2-simulation-of-random-variables-and-monte-carlo.html#simulation-of-random-variables-and-monte-carlo"><span class="toc-section-number">2</span> Simulation of Random Variables and Monte Carlo</a><ul>
<li><a href="2-1-how-to-simulate-some-common-probability-distributions.html#how-to-simulate-some-common-probability-distributions"><span class="toc-section-number">2.1</span> How to simulate some common probability distributions</a></li>
<li><a href="2-2-monte-carlo.html#monte-carlo"><span class="toc-section-number">2.2</span> Monte Carlo</a></li>
<li><a href="2-3-conditional-probability-and-independence-.html#conditional-probability-and-independence."><span class="toc-section-number">2.3</span> Conditional probability and independence.</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="how-to-simulate-some-common-probability-distributions" class="section level2">
<h2><span class="header-section-number">2.1</span> How to simulate some common probability distributions</h2>

<div class="exercise">
<span id="exr:unnamed-chunk-9" class="exercise"><strong>Problem 2.1  </strong></span>‘’Draw’’ 50 simulations from the geometric distribution with parameter <span class="math inline">\(p=0.4\)</span>.
</div>

<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">rgeom</span>(<span class="dv">50</span>,<span class="dt">prob=</span><span class="fl">0.4</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#R&gt;  [1] 1 0 3 4 1 2 0 0 2 2 0 1 5 0 1 0 2 1 1 0 2 2 2 1 0 0 1 3 2 2 1 1 1 3 5 0 1 1</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#R&gt; [39] 0 0 0 1 2 0 1 1 1 0 1 0</span></a></code></pre></div>
<p><strong>Comments</strong></p>
<p><em>R:</em> R makes it very easy to simulate draws from one of the <em>named</em> distributions, such as geometric, binomial, uniform, normal, etc. For a list of all available distributions, run <code>help(&quot;distributions&quot;)</code> Each available distribution has an <em>R name</em>; the uniform is <code>unif</code> the normal is <code>norm</code> and the binomial is <code>binom</code>, etc. If you want to simulate <span class="math inline">\(n\)</span> draws (aka a <em>sample</em> of size <span class="math inline">\(n\)</span>) from a distribution, you form a full command by appending the letter <code>r</code> to its R name and use <span class="math inline">\(n\)</span> as an argument. That is how we arrived to <code>rgeom(50)</code> in the solution above. The additional arguments of <code>rgeom</code> have to do with the parameters of that distribution. Which parameters go with which distributions, and how to input them as arguments to <code>rgeom</code> or <code>rnorm</code> is best looked up in R’s extensive documentation. Try <code>help(&quot;rnorm&quot;)</code>, for example.</p>
<em>Math:</em> You might have encountered a geometric distribution before. A random variable with that distribution can take any positive integer value or <span class="math inline">\(0\)</span>. As you can see from the output above, the value <span class="math inline">\(0\)</span> appears more often than the value <span class="math inline">\(3\)</span>, and the value <span class="math inline">\(23\)</span> does not appear at all. The probability of seeing the value <span class="math inline">\(k\in \{0,1,2,3,\dots\}\)</span> as a result of a single draw is given by <span class="math inline">\((1-p)^k p\)</span>, where <span class="math inline">\(p\)</span> is called the <em>parameter</em> of the distribution. That corresponds to the following interpretation of the geometric distribution: <em>keep tossing a biased coin (with probability <span class="math inline">\(p\)</span> of obtaining H) until you see the first H; the number of tosses yielding T before that is your geometric random variable</em>.
If we put these probabilities in a single table (and choose <span class="math inline">\(p=0.4\)</span>, for example) it is going to look like this:
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
0
</th>
<th style="text-align:right;">
1
</th>
<th style="text-align:right;">
2
</th>
<th style="text-align:right;">
3
</th>
<th style="text-align:right;">
4
</th>
<th style="text-align:right;">
5
</th>
<th style="text-align:right;">
6
</th>
<th style="text-align:right;">
7
</th>
<th style="text-align:left;">
…
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Prob.
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.144
</td>
<td style="text-align:right;">
0.086
</td>
<td style="text-align:right;">
0.052
</td>
<td style="text-align:right;">
0.031
</td>
<td style="text-align:right;">
0.019
</td>
<td style="text-align:right;">
0.011
</td>
<td style="text-align:left;">
…
</td>
</tr>
</tbody>
</table>
<p>Of course, the possible values our random variable can take do not stop at <span class="math inline">\(7\)</span>. In fact, there are infinitely many possible values, but we do not have infinite space. Note that, even though, the value <span class="math inline">\(17\)</span> does not appear in the output of the command <code>rgeom</code> above, it probably would if we simulated more than <span class="math inline">\(50\)</span> values. Let’s try it with <span class="math inline">\(500\)</span> draws:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">X &lt;-<span class="st"> </span><span class="kw">rgeom</span>(<span class="dv">500</span>, <span class="dt">prob =</span> <span class="fl">0.4</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">t</span>(<span class="kw">table</span>(X)))</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
0
</th>
<th style="text-align:right;">
1
</th>
<th style="text-align:right;">
2
</th>
<th style="text-align:right;">
3
</th>
<th style="text-align:right;">
4
</th>
<th style="text-align:right;">
5
</th>
<th style="text-align:right;">
6
</th>
<th style="text-align:right;">
7
</th>
<th style="text-align:right;">
8
</th>
<th style="text-align:right;">
9
</th>
<th style="text-align:right;">
10
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
208
</td>
<td style="text-align:right;">
132
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
<p>Still no luck, but we do observe values above 5 more often. By trial and error, we arrive at about <span class="math inline">\(1,000,000\)</span> as the required number of simulations:</p>
<table>
<thead>
<tr>
<th style="text-align:right;">
0
</th>
<th style="text-align:right;">
1
</th>
<th style="text-align:right;">
2
</th>
<th style="text-align:right;">
3
</th>
<th style="text-align:left;">
…
</th>
<th style="text-align:right;">
23
</th>
<th style="text-align:right;">
24
</th>
<th style="text-align:right;">
25
</th>
<th style="text-align:right;">
26
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
400616
</td>
<td style="text-align:right;">
238946
</td>
<td style="text-align:right;">
144274
</td>
<td style="text-align:right;">
86489
</td>
<td style="text-align:left;">
…
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
</tr>
</tbody>
</table>

<div class="exercise">
<span id="exr:unnamed-chunk-14" class="exercise"><strong>Problem 2.2  </strong></span>Compute the probability that among <span class="math inline">\(1,000,000\)</span> draws of a geometric random variable with parameter <span class="math inline">\(p=0.4\)</span>, we never see a number greater than <span class="math inline">\(22\)</span>.
</div>

<p><strong>Solution:</strong> First, we compute the probability that the value seen in a <em>single</em> draw does not exceed <span class="math inline">\(22\)</span>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">pgeom</span>(<span class="dv">22</span>,<span class="dt">prob=</span><span class="fl">0.4</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#R&gt; [1] 0.9999921</span></a></code></pre></div>
<p>Different draws are <em>independent</em> of each other, so we need to raise this to the power <span class="math inline">\(1,000,000\)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">(<span class="kw">pgeom</span>(<span class="dv">22</span>,<span class="dt">prob=</span><span class="fl">0.4</span>))<span class="op">^</span>(<span class="dv">1000000</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#R&gt; [1] 0.0003717335</span></a></code></pre></div>
<p><strong>Comments:</strong></p>
<p><em>R.</em> The command we used here is <code>pgeom</code> which is a cousin of <code>rgeom</code>. In general R commands that involve named probability distributions consist of two parts. The prefix, i.e., the initial letter (<code>p</code> in this case) stands for the operation you want to perform, and the rest is the R name of the distribution. There are 4 prefixes, and the commands they produce are</p>
<table>
<colgroup>
<col width="27%" />
<col width="72%" />
</colgroup>
<thead>
<tr class="header">
<th>Prefix</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>r</code></td>
<td>Simulate <strong>r</strong>andom draws from the distribution.</td>
</tr>
<tr class="even">
<td><code>p</code></td>
<td>Compute the cumulative <strong>p</strong>robability distribution function (cdf)</td>
</tr>
<tr class="odd">
<td><code>d</code></td>
<td>Compute the probability <strong>d</strong>ensity (pdf) or the probability mass function (pmf)</td>
</tr>
<tr class="even">
<td><code>q</code></td>
<td>Compute the <strong>q</strong>uantile function</td>
</tr>
</tbody>
</table>
<p>(see the Math section below for the reminder of what these things are. ) In this problem, we are dealing with a geometric random variable <span class="math inline">\(X\)</span>, which has a discrete distribution, with support <span class="math inline">\(0,1,2,3,\dots\)</span>. Therefore, the R name is <code>geom</code>. We are interested in the probability <span class="math inline">\({\mathbb{P}}[ X\leq 22]\)</span>, which corresponds to the cdf of <span class="math inline">\(X\)</span> at <span class="math inline">\(x=22\)</span>, so we use the
the prefix <code>p</code>. Finally, we used the named parameter <code>p</code> and gave it the value <code>p = 0.4</code>, because the geometric distribution has a single parameter <span class="math inline">\(p\)</span>.</p>
<p>This problem also gives us a chance to discuss precision. As you can see, the probability of a single draw not exceeding <span class="math inline">\(22\)</span> is very close to <span class="math inline">\(1\)</span>. In fact, it is equal to it to 5 decimal places. By default, R displays 7 significant digits of a number. That is enough for most applications, but sometimes we need more precision. For example, let’s try to compute the probability of seeing no T (tails) in 10 tosses of a biased coin, where the probability of H (heads) is 0.9.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="dv">1</span><span class="fl">-0.1</span><span class="op">^</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#R&gt; [1] 1</span></a></code></pre></div>
<p>While small, this probability is clearly not equal to <span class="math inline">\(1\)</span>, as suggested by the output above.
The culprit is the default precision. We can increase the precision (up to <span class="math inline">\(22\)</span> digits) by running <code>options(digits=14)</code></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">options</span>(<span class="dt">digits=</span><span class="dv">17</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="dv">1</span><span class="fl">-0.1</span><span class="op">^</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#R&gt; [1] 0.99999999989999999</span></a></code></pre></div>
<p>Problems like this should not appear in this course, but they will out there “in the wild”, so it might be a good idea to be aware of them.</p>
<p><em>Math.</em> If you forgot all about pdfs, cdfs and such things here is a little reminder:
And here is a reminder what these quantities are:</p>
<table>
<colgroup>
<col width="45%" />
<col width="54%" />
</colgroup>
<tbody>
<tr class="odd">
<td>cdf</td>
<td><span class="math inline">\(F(x) = {\mathbb{P}}[X\leq x]\)</span></td>
</tr>
<tr class="even">
<td>pdf</td>
<td><span class="math inline">\(f(x)\)</span> such that <span class="math inline">\(\int_a^b f(x) \, dx = {\mathbb{P}}[X \in [a,b]]\)</span> for all <span class="math inline">\(a&lt;b\)</span></td>
</tr>
<tr class="odd">
<td>pmf</td>
<td><span class="math inline">\(p(x)\)</span> such that <span class="math inline">\({\mathbb{P}}[X=a_n] = p(a_n)\)</span> for some sequence <span class="math inline">\(a_n\)</span></td>
</tr>
<tr class="even">
<td>qf</td>
<td><span class="math inline">\(q(p)\)</span> is a number such that <span class="math inline">\({\mathbb{P}}[ X \leq q(p)] = p\)</span></td>
</tr>
</tbody>
</table>
<p>Those random variables that admit a pdf are called <strong>continuous</strong>. The prime examples are the normal, or the exponential distribution. The ones where a pmf exists are called <strong>discrete</strong>. The sequence <span class="math inline">\(a_n\)</span> is simply the sequence of all values that such a, discrete, random variable can take. Most often, <span class="math inline">\(a_n\)</span> is either the set of all natural numbers <span class="math inline">\(0,1,2,\dots\)</span> or a finite subset such that <span class="math inline">\(0,1,2,3,4,5\)</span>, called the <strong>support</strong> of the distribution.</p>
<p>Btw, this probability we obtained is quite small. Since <span class="math inline">\(1/0.000372\)</span> is about <span class="math inline">\(2690\)</span>, we would have to run about <span class="math inline">\(2690\)</span> rounds of <span class="math inline">\(1,000,000\)</span> simulations before the largest number falls below <span class="math inline">\(23\)</span>.</p>

<div class="exercise">
<span id="exr:unnamed-chunk-18" class="exercise"><strong>Problem 2.3  </strong></span>Compute the <span class="math inline">\(0.05\)</span>, <span class="math inline">\(0.1\)</span>, <span class="math inline">\(0.4\)</span>, <span class="math inline">\(0.6\)</span> and <span class="math inline">\(0.95\)</span> quantiles of the normal distribution with mean <span class="math inline">\(1\)</span> and standard deviation <span class="math inline">\(2\)</span>.
</div>

<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">qnorm</span>( <span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.95</span>), <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#R&gt; [1] -2.2897073 -1.5631031  0.4933058  1.5066942  4.2897073</span></a></code></pre></div>
<p><em>R.</em> The function we used is <code>qnorm</code>, with the prefix <code>q</code> which computes the quantile function and the R name <code>norm</code> because we are looking for the quantiles of the normal distribution. The additinal (named) parameters are where the parameters of the distribution come in (the mean and the standard variation) in this case. Note how we plugged in the entire vector <code>c(0.05, 0.1, 0.4, 0.6, 0.98)</code> instead of a single value into <code>qnorm</code>. You can do that because this function is <strong>vectorized</strong>. That means that if you give it a vector as an argument, it will return a vector with values corresponding to each element of the input. Many (but not all) functions in R are vectorized.</p>
<p>As a sanity check, let’s apply the cdf to these quantile values:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">p &lt;-<span class="st">  </span><span class="kw">qnorm</span>( <span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.95</span>), <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw">pnorm</span>( p , <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#R&gt; [1] 0.05 0.10 0.40 0.60 0.95</span></a></code></pre></div>
<p>As expected, we got the original values back - the normal quantile function and its cdf are inverses of each other.</p>

<div class="exercise">
<span id="exr:unnamed-chunk-21" class="exercise"><strong>Problem 2.4  </strong></span>Simulate <span class="math inline">\(60\)</span> throws of a fair <span class="math inline">\(10\)</span>-sided die.
</div>

<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">sample</span>( <span class="dv">1</span><span class="op">:</span><span class="dv">10</span> , <span class="dv">60</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#R&gt;  [1]  2  8  9  8  4  7  7  7  2  3  3 10  6  1  9  7  4  7  6  2  2  3 10  1  9</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#R&gt; [26]  7  3  2  8  4  1  2  8  1  4  9  1  9 10 10  6  1  8  6  1 10  5  1  6  9</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">#R&gt; [51]  8  3  8  9  4  6  1  6  7  8</span></a></code></pre></div>
<p><strong>Comments</strong>:</p>
<p><em>Math.</em> Let <span class="math inline">\(X\)</span> denote the outcome of a single throw of this strange die. The distribution of <span class="math inline">\(X\)</span> is discrete (it can only take the values <span class="math inline">\(1,2,\dots, n\)</span>) but it is not one of the named distributions. The way we describe such distribution is by a <strong>distribution table</strong>, which is really just a list of possible values a random variable can take, together with their, respective, probabilities.</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
1
</th>
<th style="text-align:left;">
2
</th>
<th style="text-align:left;">
3
</th>
<th style="text-align:left;">
4
</th>
<th style="text-align:left;">
5
</th>
<th style="text-align:left;">
6
</th>
<th style="text-align:left;">
7
</th>
<th style="text-align:left;">
8
</th>
<th style="text-align:left;">
9
</th>
<th style="text-align:left;">
10
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
</tr>
</tbody>
</table>
<p><em>R.</em> The command used to draw a sample from a (finite) collection is, of, course <code>sample</code>. The first argument is a vector, and it contains the “bag” from which you are drawing. If we are interested in repeated, random samples, we also need to specity <code>replace = FALSE</code> otherwise, you could draw any signle number am most once:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">8</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">#R&gt; [1]  1  5  6  7  8 10  3  4</span></a></code></pre></div>
<p>With more than 10 draws, we would run out of numbers to draw:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">12</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">#R&gt; Error in sample.int(length(x), size, replace, prob): cannot take a sample larger than the population when &#39;replace = FALSE&#39;</span></a></code></pre></div>
<p>The bag you draw from can contain objects other than numbers:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">sample</span>( <span class="kw">c</span>(<span class="st">&quot;Alice&quot;</span>, <span class="st">&quot;Bob&quot;</span>, <span class="st">&quot;Charlie&quot;</span>), <span class="dv">8</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="co">#R&gt; [1] &quot;Charlie&quot; &quot;Bob&quot;     &quot;Alice&quot;   &quot;Charlie&quot; &quot;Bob&quot;     &quot;Charlie&quot; &quot;Charlie&quot;</span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co">#R&gt; [8] &quot;Charlie&quot;</span></a></code></pre></div>
So far, each object in the bag had the same probability of being drawn. You can use the <code>sample</code> command to produce a <em>weighted</em> sample, too. For example, if we wanted to simulate <span class="math inline">\(10\)</span> draws from the following distribution
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
1
</th>
<th style="text-align:right;">
2
</th>
<th style="text-align:right;">
3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.7
</td>
<td style="text-align:right;">
0.1
</td>
</tr>
</tbody>
</table>
<p>we would use the additional argument <code>prob</code>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">sample</span>( <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.7</span>, <span class="fl">0.1</span>))</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co">#R&gt;  [1] 2 2 2 2 1 2 2 2 2 1</span></a></code></pre></div>
<p>Note how it is mostly <span class="math inline">\(2\)</span>s.</p>

<div class="exercise">
<span id="exr:unnamed-chunk-29" class="exercise"><strong>Problem 2.5  </strong></span>Draw a sample of <span class="math inline">\(n=10\)</span> from the normal distribution with parameters <span class="math inline">\(\mu=1\)</span>, <span class="math inline">\(\sigma = 2\)</span>. Plot a historgram of the obtained values. Repeat for <span class="math inline">\(n=100\)</span> and <span class="math inline">\(n=100000\)</span>.
</div>

<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw">hist</span>(x)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-30-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="kw">hist</span>(x)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-31-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100000</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw">hist</span>(x)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-32-1.png" width="672" style="display: block; margin: auto;" />
<strong>Comments:</strong></p>
<p><em>R.</em> It cannot be simpler! You use the command <code>hist</code>, feed it a vector of values, and it produces a histogram. It will even labels the axes. If you want to learn how to tweak various features of your histogram, type <code>?hist</code>.</p>
<p>Esthetically, the built-in histograms leave something to be desired. We can do better, using the package <code>ggplot2</code>. You don’t have to use it in this class, but if you want to, you install it first by running <code>install.packages(&quot;ggplot2&quot;)</code> (you have to do this only once). Then, every time you want to use it, you run <code>library(ggplot2)</code> to notify R that you are aobut to use a function from that package. It would take a whole semester to learn everything there is to know about <code>ggplot2</code>; I will only show what a histogram looks like in it:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100000</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="kw">qplot</span>(x, <span class="dt">bins=</span><span class="dv">40</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-1.png" width="672" style="display: block; margin: auto;" />
<em>Math</em>. Mathematically, histogram can be produced for any (finite) sequence of numbers: we divide the range into several bins, count how many of the points in the sequence falls into which bin, and then draw a bar above that bin whose height is equal (or proportional to) that count. The picture tells use about how the sequence we started from is “distributed”. The order of the points does not matter - you would get exactly the same picture if you presorted the points. If the sequence of points you draw the histogram comes from, say, normal distribution, the histogram will resemble the shape of the pdf of a normal distribution. I say resemble, because its shape is ultimately random. If the number of points is small (like in the second part of this problem) the histogram may look nothing like the normal pdf. However, when the number of points gets larger and larger, the shape of the histogram gets closer and closer to the underlying pdf (if it exists). I keep writing “shape” because the the three histograms above have very different scales on the <span class="math inline">\(y\)</span> axis. That is because we used counts to set the sizes of bins. A more natural choice is to use the proportions, i.e. relative frequencies (i.e. counts divided by the total number of points) for bar heights. In R, we would need to add an additional option to <code>hist</code>:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100000</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="kw">hist</span>(x,<span class="dt">freq =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-34-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>With such a normalization, the histogram of <span class="math inline">\(x\)</span> can be directly compared to the probability density of a normal distribution. Here is a picture. Its R code is a little bit too advanced for now, so I am skipping it:</p>
<p><img src="_main_files/figure-html/unnamed-chunk-35-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<p style="text-align: center;">
<a href="2-simulation-of-random-variables-and-monte-carlo.html"><button class="btn btn-default">Previous</button></a>
<a href="https://github.com/gordanz/M362M/edit/master/02-simulation.Rmd"><button class="btn btn-default">Edit</button></a>
<a href="2-2-monte-carlo.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
