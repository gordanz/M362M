<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Simulation of Random Variables and Monte Carlo | Lecture notes for &quot;Introduction to Stochastic Processes&quot;</title>
  <meta name="description" content="A set of lecture notes for M362M: Introduction to Stochastic Processes" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Simulation of Random Variables and Monte Carlo | Lecture notes for &quot;Introduction to Stochastic Processes&quot;" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A set of lecture notes for M362M: Introduction to Stochastic Processes" />
  <meta name="github-repo" content="gordanz/M362M" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Simulation of Random Variables and Monte Carlo | Lecture notes for &quot;Introduction to Stochastic Processes&quot;" />
  
  <meta name="twitter:description" content="A set of lecture notes for M362M: Introduction to Stochastic Processes" />
  

<meta name="author" content="Gordan Zitkovic" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="dist.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">M362M Lecture notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> An intro to R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#setting-up-an-r-environment-on-your-computer"><i class="fa fa-check"></i><b>1.1</b> Setting up an R environment on your computer</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#installing-r"><i class="fa fa-check"></i><b>1.1.1</b> Installing R</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#installing-rstudio"><i class="fa fa-check"></i><b>1.1.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="1.1.3" data-path="intro.html"><a href="intro.html#installing-basic-packages"><i class="fa fa-check"></i><b>1.1.3</b> Installing basic packages</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#learning-the-basics-of-r"><i class="fa fa-check"></i><b>1.2</b> Learning the basics of R</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#the-console-scripts-and-r-notebooks"><i class="fa fa-check"></i><b>1.2.1</b> The console, Scripts and R Notebooks</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#asking-for-help"><i class="fa fa-check"></i><b>1.2.2</b> Asking for help</a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#vectors"><i class="fa fa-check"></i><b>1.2.3</b> Vectors</a></li>
<li class="chapter" data-level="1.2.4" data-path="intro.html"><a href="intro.html#matrices"><i class="fa fa-check"></i><b>1.2.4</b> Matrices</a></li>
<li class="chapter" data-level="1.2.5" data-path="intro.html"><a href="intro.html#functions"><i class="fa fa-check"></i><b>1.2.5</b> Functions</a></li>
<li class="chapter" data-level="1.2.6" data-path="intro.html"><a href="intro.html#if-else-statements"><i class="fa fa-check"></i><b>1.2.6</b> If-else statements</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#problems"><i class="fa fa-check"></i><b>1.3</b> Problems</a></li>
</ul></li>
<li class="part"><span><b>I Probability and Simulation</b></span></li>
<li class="chapter" data-level="2" data-path="simulation-of-random-variables-and-monte-carlo.html"><a href="simulation-of-random-variables-and-monte-carlo.html"><i class="fa fa-check"></i><b>2</b> Simulation of Random Variables and Monte Carlo</a>
<ul>
<li class="chapter" data-level="2.1" data-path="simulation-of-random-variables-and-monte-carlo.html"><a href="simulation-of-random-variables-and-monte-carlo.html#simulation-of-some-common-probability-distributions"><i class="fa fa-check"></i><b>2.1</b> Simulation of some common probability distributions</a></li>
<li class="chapter" data-level="2.2" data-path="simulation-of-random-variables-and-monte-carlo.html"><a href="simulation-of-random-variables-and-monte-carlo.html#multivariate-distributions"><i class="fa fa-check"></i><b>2.2</b> Multivariate Distributions</a></li>
<li class="chapter" data-level="2.3" data-path="simulation-of-random-variables-and-monte-carlo.html"><a href="simulation-of-random-variables-and-monte-carlo.html#additional-problems"><i class="fa fa-check"></i><b>2.3</b> Additional Problems</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="dist.html"><a href="dist.html"><i class="fa fa-check"></i><b>A</b> Probability Distributions</a>
<ul>
<li class="chapter" data-level="A.1" data-path="dist.html"><a href="dist.html#discrete-distributions"><i class="fa fa-check"></i><b>A.1</b> Discrete distributions:</a></li>
<li class="chapter" data-level="A.2" data-path="dist.html"><a href="dist.html#continuous-distributions"><i class="fa fa-check"></i><b>A.2</b> Continuous distributions:</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Lecture notes for "Introduction to Stochastic Processes"</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulation-of-random-variables-and-monte-carlo" class="section level1" number="2">
<h1><span class="header-section-number">Chapter 2</span> Simulation of Random Variables and Monte Carlo</h1>
<p>In the spirit of “learn by doing”, these lecture notes contain many “Problems”.
Those with solutions usually introduce new concepts and feature a <em>Comments</em>
section right after the solution. These comments are subdivided into <em>R</em> and
<em>Math</em> comments focusing on the computational or conceptual features,
respectively. Note that you are not expected to be able to do the solved
problems before reading their solutions and comments, so don’t worry if you
cannot. It is a good practice to try, though. Problems which are left unsolved,
however, do not feature any new ideas and are there to help you practice the
skills presented before.</p>
<div id="simulation-of-some-common-probability-distributions" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Simulation of some common probability distributions</h2>
<p>… where we also review some probability along the way.</p>

<div class="exercise">
<span id="exr:unnamed-chunk-2" class="exercise"><strong>Problem 2.1  </strong></span>‘’Draw’’ 50 simulations from the geometric distribution with parameter <span class="math inline">\(p=0.4\)</span>.
</div>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb1-1" aria-hidden="true"></a><span class="kw">rgeom</span>(<span class="dv">50</span>, <span class="dt">prob =</span> <span class="fl">0.4</span>)</span>
<span id="cb1-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb1-2" aria-hidden="true"></a><span class="co">##  [1] 1 0 3 4 1 2 0 0 2 2 0 1 5 0 1 0 2 1 1 0 2 2 2 1 0 0 1 3 2 2 1 1 1 3 5 0 1 1</span></span>
<span id="cb1-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb1-3" aria-hidden="true"></a><span class="co">## [39] 0 0 0 1 2 0 1 1 1 0 1 0</span></span></code></pre></div>
<p><strong>Comments</strong></p>
<p><em>R:</em> R makes it very easy to simulate draws from a large class of <em>named
distributions</em><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>,
such as geometric, binomial, uniform, normal, etc. For a list of all available
distributions, run <code>help("distributions")</code> Each available distribution has an <em>R
name</em>; the uniform is <code>unif</code> the normal is <code>norm</code> and the binomial is <code>binom</code>,
etc. If you want to simulate <span class="math inline">\(n\)</span> draws (aka a <em>sample</em> of size <span class="math inline">\(n\)</span>) from a
distribution, you form a full command by appending the letter <code>r</code> to its R name
and use <span class="math inline">\(n\)</span> as an argument. That is how we arrived to <code>rgeom(50)</code> in the
solution above. The additional arguments of the function <code>rgeom</code> have to do with
the parameters of that distribution. Which parameters go with which
distributions, and how to input them as arguments to <code>rgeom</code> or <code>rnorm</code> is best
looked up in R’s extensive documentation. Try <code>help("rnorm")</code>, for example.</p>
<p><em>Math:</em>
You could spend your whole life trying to understand what it really means to
“simulate” or “generate” a random number. The numbers you obtain from so-called
<em>random number generators</em> (RNG) are never random. In fact, they are completely
deterministically generated. Still, sequences of numbers obtained from (good)
random number generators share so many properties with sequences of mythical
<em>truly</em> random numbers, that we can use them as if they were truly random. For
the purposes of this class, you can assume that the numbers R gives you as
<em>random</em> are random enough. Random number generation is a fascinating topic at
the intersection of number theory, probability, statistics, computer science and
even philosophy, but we do not have the time to cover any of it in this class.
If you want to read a story about a particularly bad random number generator, go
<a href="https://en.wikipedia.org/wiki/RANDU">here</a>.</p>
<p>You might have encountered a geometric distribution before. A random variable with that
distribution can take any positive integer value or <span class="math inline">\(0\)</span>, i.e., its support is
<span class="math inline">\({\mathbb N}_0=\{0,1,2,3,\dots\}\)</span>.
As you can see from the output above, the value <span class="math inline">\(0\)</span> appears more often than the value <span class="math inline">\(3\)</span>,
and the value <span class="math inline">\(23\)</span> does not appear at all in this particular simulation run. The
probability of seeing the value <span class="math inline">\(k\in \{0,1,2,3,\dots\}\)</span> as a result of a single
draw is given by <span class="math inline">\((1-p)^k p\)</span>, where <span class="math inline">\(p\)</span> is called the <em>parameter</em> of the distribution.</p>
That corresponds to the following interpretation of the geometric distribution:
keep tossing a biased coin (with probability p of obtaining H) until you see the first H; the number Ts before that is that value your geometric random variable<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>
If we put these probabilities in a single table (and choose <span class="math inline">\(p=0.4\)</span>, for example) it is
going to look like this:
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
0
</th>
<th style="text-align:right;">
1
</th>
<th style="text-align:right;">
2
</th>
<th style="text-align:right;">
3
</th>
<th style="text-align:right;">
4
</th>
<th style="text-align:right;">
5
</th>
<th style="text-align:right;">
6
</th>
<th style="text-align:right;">
7
</th>
<th style="text-align:left;">
…
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Prob.
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.144
</td>
<td style="text-align:right;">
0.086
</td>
<td style="text-align:right;">
0.052
</td>
<td style="text-align:right;">
0.031
</td>
<td style="text-align:right;">
0.019
</td>
<td style="text-align:right;">
0.011
</td>
<td style="text-align:left;">
…
</td>
</tr>
</tbody>
</table>
<p>Of course, the possible values our random variable can take do not stop at <span class="math inline">\(7\)</span>.
In fact, there are infinitely many possible values, but we do not have infinite
space. Note that even though the value <span class="math inline">\(23\)</span> does not appear in the output of the
command <code>rgeom</code> above, it probably would if we simulated many more than <span class="math inline">\(50\)</span>
values. Let’s try it with <span class="math inline">\(500\)</span> draws - the table below counts how many <span class="math inline">\(0s\)</span>,
<span class="math inline">\(1s\)</span>, <span class="math inline">\(2s\)</span>, etc. we got:</p>
<table>
<thead>
<tr>
<th style="text-align:right;">
0
</th>
<th style="text-align:right;">
1
</th>
<th style="text-align:right;">
2
</th>
<th style="text-align:right;">
3
</th>
<th style="text-align:right;">
4
</th>
<th style="text-align:right;">
5
</th>
<th style="text-align:right;">
6
</th>
<th style="text-align:right;">
7
</th>
<th style="text-align:right;">
8
</th>
<th style="text-align:right;">
9
</th>
<th style="text-align:right;">
10
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
208
</td>
<td style="text-align:right;">
132
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
<p>Still no luck, but we do observe values above 5 more often. By trial and error,
we arrive at about <span class="math inline">\(1,000,000\)</span> as the required number of simulations:</p>
<table>
<thead>
<tr>
<th style="text-align:right;">
0
</th>
<th style="text-align:right;">
1
</th>
<th style="text-align:right;">
2
</th>
<th style="text-align:right;">
3
</th>
<th style="text-align:left;">
…
</th>
<th style="text-align:right;">
23
</th>
<th style="text-align:right;">
24
</th>
<th style="text-align:right;">
25
</th>
<th style="text-align:right;">
26
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
400616
</td>
<td style="text-align:right;">
238946
</td>
<td style="text-align:right;">
144274
</td>
<td style="text-align:right;">
86489
</td>
<td style="text-align:left;">
…
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
</tr>
</tbody>
</table>

<div class="exercise">
<span id="exr:unnamed-chunk-7" class="exercise"><strong>Problem 2.2  </strong></span>Compute the probability that among <span class="math inline">\(1,000,000\)</span> draws of a geometric random
variable with parameter <span class="math inline">\(p=0.4\)</span>, we never see a number greater than <span class="math inline">\(22\)</span>.
</div>
<p><strong>Solution:</strong> First, we compute the probability that the value seen in a <em>single</em> draw does not exceed <span class="math inline">\(22\)</span>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb2-1" aria-hidden="true"></a><span class="kw">pgeom</span>(<span class="dv">22</span>, <span class="dt">prob =</span> <span class="fl">0.4</span>)</span>
<span id="cb2-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb2-2" aria-hidden="true"></a><span class="co">## [1] 0.9999921</span></span></code></pre></div>
<p>Different draws are <em>independent</em> of each other, so we need to raise this to the power <span class="math inline">\(1,000,000\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb3-1" aria-hidden="true"></a>(<span class="kw">pgeom</span>(<span class="dv">22</span>, <span class="dt">prob =</span> <span class="fl">0.4</span>))<span class="op">^</span>(<span class="fl">1e+06</span>)</span>
<span id="cb3-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb3-2" aria-hidden="true"></a><span class="co">## [1] 0.0003717335</span></span></code></pre></div>
<p><strong>Comments:</strong></p>
<p><em>R.</em> The command we used here is <code>pgeom</code> which is a cousin of <code>rgeom</code>. In
general, R commands that involve named probability distributions consist of two
parts. The prefix, i.e., the initial letter (<code>p</code> in this case) stands for the
operation you want to perform, and the rest is the R name of the distribution.
There are 4 prefixes, and the commands they produce are</p>
<table>
<colgroup>
<col width="18%" />
<col width="81%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Prefix</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>r</code></td>
<td align="left">Simulate <strong>r</strong>andom draws from the distribution.</td>
</tr>
<tr class="even">
<td align="left"><code>p</code></td>
<td align="left">Compute the cumulative <strong>p</strong>robability distribution function (cdf) (<strong>NOT pdf</strong>)</td>
</tr>
<tr class="odd">
<td align="left"><code>d</code></td>
<td align="left">Compute the probability <strong>d</strong>ensity (pdf) or the probability mass function (pmf)</td>
</tr>
<tr class="even">
<td align="left"><code>q</code></td>
<td align="left">Compute the <strong>q</strong>uantile function</td>
</tr>
</tbody>
</table>
<p>(see the Math section below for the reminder of what these things are). In this
problem, we are dealing with a geometric random variable <span class="math inline">\(X\)</span>, which has a
discrete distribution with support <span class="math inline">\(0,1,2,3,\dots\)</span>. Therefore, the R name is
<code>geom</code>. We are interested in the probability <span class="math inline">\({\mathbb{P}}[ X\leq 22]\)</span>, which
corresponds to the cdf of <span class="math inline">\(X\)</span> at <span class="math inline">\(x=22\)</span>, so we use the
the prefix <code>p</code>. Finally, we used the named parameter <code>p</code> and gave it the value <code>p = 0.4</code>, because the geometric distribution has a single parameter <span class="math inline">\(p\)</span>.</p>
<p>This problem also gives us a chance to discuss precision. As you can see, the
probability of a single draw not exceeding <span class="math inline">\(22\)</span> is very close to <span class="math inline">\(1\)</span>. In fact,
it is equal to it to 5 decimal places. By default, R displays 7 significant
digits of a number. That is enough for most applications (and barely enough for
this one), but sometimes we need more. For example, let’s try to compute the
probability of seeing no T (tails) in 10 tosses of a biased coin, where the
probability of H (heads) is 0.9.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb4-1" aria-hidden="true"></a><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.1</span><span class="op">^</span><span class="dv">10</span></span>
<span id="cb4-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb4-2" aria-hidden="true"></a><span class="co">## [1] 1</span></span></code></pre></div>
<p>While very close to it, this probability is clearly not equal to <span class="math inline">\(1\)</span>, as suggested by the output above.
The culprit is the default precision. We can increase the precision (up to <span class="math inline">\(22\)</span> digits) using the <code>options</code> command</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb5-1" aria-hidden="true"></a><span class="kw">options</span>(<span class="dt">digits =</span> <span class="dv">17</span>)</span>
<span id="cb5-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb5-2" aria-hidden="true"></a><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.1</span><span class="op">^</span><span class="dv">10</span></span>
<span id="cb5-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb5-3" aria-hidden="true"></a><span class="co">## [1] 0.99999999989999999</span></span></code></pre></div>
<p>Precision issues like this one should not appear in this course, but they will
out there “in the wild”, so it might be a good idea to be aware of them.</p>
<p><em>Math.</em> If you forgot all about pdfs, cdfs and such things here is a little reminder:</p>
<table>
<colgroup>
<col width="13%" />
<col width="86%" />
</colgroup>
<tbody>
<tr class="odd">
<td>cdf</td>
<td><span class="math inline">\(F(x) = {\mathbb{P}}[X\leq x]\)</span></td>
</tr>
<tr class="even">
<td>pdf</td>
<td><span class="math inline">\(f(x)\)</span> such that <span class="math inline">\({\mathbb{P}}[X \in [a,b]] = \int_a^b f(x) \, dx\)</span> for all <span class="math inline">\(a&lt;b\)</span></td>
</tr>
<tr class="odd">
<td>pmf</td>
<td><span class="math inline">\(p(x)\)</span> such that <span class="math inline">\({\mathbb{P}}[X=a_n] = p(a_n)\)</span> for some sequence <span class="math inline">\(a_n\)</span></td>
</tr>
<tr class="even">
<td>qf</td>
<td><span class="math inline">\(q(p)\)</span> is a number such that <span class="math inline">\({\mathbb{P}}[ X \leq q(p)] = p\)</span></td>
</tr>
</tbody>
</table>
<p>Those random variables that admit a pdf are called <strong>continuous</strong>. The prime
examples are the normal, or the exponential distribution. The ones where a pmf
exists are called <strong>discrete</strong>. The sequence <span class="math inline">\(a_n\)</span> covers all values that such
a, discrete, random variable can take. Most often, <span class="math inline">\(a_n\)</span> either covers the set
of all natural numbers <span class="math inline">\(0,1,2,\dots\)</span> or a finite subset such as <span class="math inline">\(1,2,3,4,5,6\)</span>.</p>
<p>Coming back to our original problem, we note that the probability we obtained is
quite small. Since <span class="math inline">\(1/0.000372\)</span> is about <span class="math inline">\(2690\)</span>, we would have to run about
<span class="math inline">\(2690\)</span> rounds of <span class="math inline">\(1,000,000\)</span> simulations before the largest number falls below
<span class="math inline">\(23\)</span>.</p>

<div class="exercise">
<span id="exr:unnamed-chunk-11" class="exercise"><strong>Problem 2.3  </strong></span>Compute the <span class="math inline">\(0.05\)</span>, <span class="math inline">\(0.1\)</span>, <span class="math inline">\(0.4\)</span>, <span class="math inline">\(0.6\)</span> and <span class="math inline">\(0.95\)</span> quantiles of the normal
distribution with mean <span class="math inline">\(1\)</span> and standard deviation <span class="math inline">\(2\)</span>.
</div>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb6-1" aria-hidden="true"></a><span class="kw">qnorm</span>(<span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.95</span>), <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb6-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb6-2" aria-hidden="true"></a><span class="co">## [1] -2.2897073 -1.5631031  0.4933058  1.5066942  4.2897073</span></span></code></pre></div>
<p><em>R.</em> The function we used is <code>qnorm</code>, with the prefix <code>q</code> which computes the
quantile function and the R name <code>norm</code> because we are looking for the quantiles
of the normal distribution. The additional (named) parameters are where the
parameters of the distribution come in (the mean and the standard variation) in
this case. Note how we plugged in the entire vector
<code>c(0.05, 0.1, 0.4, 0.6, 0.98)</code> instead of a single value into <code>qnorm</code>. You can
do that because this function is <strong>vectorized</strong>. That means that if you give it
a vector as an argument, it will “apply itself” to each component of the vector
separately, and return the vector of results. Many (but not all) functions in R
are vectorized<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>.</p>
<p>As a sanity check, let’s apply <code>pnrom</code> (which computes the cdf of the normal) to these quantile values:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb7-1" aria-hidden="true"></a>p =<span class="st"> </span><span class="kw">qnorm</span>(<span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.95</span>), <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb7-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb7-2" aria-hidden="true"></a><span class="kw">pnorm</span>(p, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb7-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb7-3" aria-hidden="true"></a><span class="co">## [1] 0.05 0.10 0.40 0.60 0.95</span></span></code></pre></div>
<p>As expected, we got the original values back - the normal quantile function and its cdf are inverses of each other.</p>
<p><em>Math.</em> Computing the cdf of a standard normal is the same thing reading a
<em>normal table</em>. Computing a quantile is the opposite; you go into the middle of
the table and find your value, and then figure out which “Z” would give you that
value.</p>

<div class="exercise">
<span id="exr:unnamed-chunk-14" class="exercise"><strong>Problem 2.4  </strong></span>Simulate <span class="math inline">\(60\)</span> throws of a fair <span class="math inline">\(10\)</span>-sided die.
</div>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb8-1" aria-hidden="true"></a><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">60</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb8-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb8-2" aria-hidden="true"></a><span class="co">##  [1]  2  8  9  8  4  7  7  7  2  3  3 10  6  1  9  7  4  7  6  2  2  3 10  1  9</span></span>
<span id="cb8-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb8-3" aria-hidden="true"></a><span class="co">## [26]  7  3  2  8  4  1  2  8  1  4  9  1  9 10 10  6  1  8  6  1 10  5  1  6  9</span></span>
<span id="cb8-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb8-4" aria-hidden="true"></a><span class="co">## [51]  8  3  8  9  4  6  1  6  7  8</span></span></code></pre></div>
<p><strong>Comments</strong>:</p>
<p><em>Math.</em> Let <span class="math inline">\(X\)</span> denote the outcome of a single throw of a fair <span class="math inline">\(10\)</span>-sided die.
The distribution of <span class="math inline">\(X\)</span> is discrete (it can only take the values
<span class="math inline">\(1,2,\dots, 10\)</span>) but it is not one of the more famous named distributions. I
guess you could call it a <em>discrete uniform on <span class="math inline">\({1,2,\dots, 10}\)</span></em>, but a better
way to describe such distribution is by a <strong>distribution table</strong>, which is
really just a list of possible values a random variable can take, together with
their, respective, probabilities. In this case,</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
1
</th>
<th style="text-align:left;">
2
</th>
<th style="text-align:left;">
3
</th>
<th style="text-align:left;">
4
</th>
<th style="text-align:left;">
5
</th>
<th style="text-align:left;">
6
</th>
<th style="text-align:left;">
7
</th>
<th style="text-align:left;">
8
</th>
<th style="text-align:left;">
9
</th>
<th style="text-align:left;">
10
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
</tr>
</tbody>
</table>
<p><em>R.</em> The command used to draw a sample from a (finite) collection is, of, course
<code>sample</code>. The first argument is a vector, and it plays the role of the “bag”
from which you are drawing. If we are interested in repeated, random samples, we
also need to specify <code>replace = FALSE</code> otherwise, you could draw any single
number at most once:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb9-1" aria-hidden="true"></a><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">8</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb9-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb9-2" aria-hidden="true"></a><span class="co">## [1]  1  5  6  7  8 10  3  4</span></span></code></pre></div>
<p>With more than 10 draws, we would run out of numbers to draw:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb10-1" aria-hidden="true"></a><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">12</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb10-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb10-2" aria-hidden="true"></a><span class="co">## Error in sample.int(length(x), size, replace, prob): cannot take a sample larger than the population when &#39;replace = FALSE&#39;</span></span></code></pre></div>
<p>The bag you draw from can contain objects other than numbers:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb11-1" aria-hidden="true"></a><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;Picard&quot;</span>, <span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Geordi&quot;</span>), <span class="dv">9</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb11-2" aria-hidden="true"></a><span class="co">## [1] &quot;Picard&quot; &quot;Data&quot;   &quot;Geordi&quot; &quot;Geordi&quot; &quot;Data&quot;   &quot;Data&quot;   &quot;Picard&quot; &quot;Data&quot;  </span></span>
<span id="cb11-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb11-3" aria-hidden="true"></a><span class="co">## [9] &quot;Geordi&quot;</span></span></code></pre></div>
So far, each object in the bag had the same probability of being drawn. You can
use the <code>sample</code> command to produce a <em>weighted</em> sample, too. For example, if we
wanted to simulate <span class="math inline">\(10\)</span> draws from the following distribution
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
1
</th>
<th style="text-align:right;">
2
</th>
<th style="text-align:right;">
3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.7
</td>
<td style="text-align:right;">
0.1
</td>
</tr>
</tbody>
</table>
<p>we would use the additional argument <code>prob</code>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb12-1" aria-hidden="true"></a><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span>))</span>
<span id="cb12-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb12-2" aria-hidden="true"></a><span class="co">##  [1] 1 2 2 1 1 2 2 3 2 2</span></span></code></pre></div>
<p>Note how it is mostly <span class="math inline">\(2\)</span>s, as expected.</p>

<div class="exercise">
<span id="exr:unnamed-chunk-22" class="exercise"><strong>Problem 2.5  </strong></span>Draw a sample of size <span class="math inline">\(n=10\)</span> from <span class="math inline">\(N(1,2)\)</span>, i.e., from the normal distribution
with parameters <span class="math inline">\(\mu=1\)</span>, <span class="math inline">\(\sigma = 2\)</span>. Plot a histogram of the obtained
values. Repeat for <span class="math inline">\(n=100\)</span> and <span class="math inline">\(n=100000\)</span>.
</div>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb13-1" aria-hidden="true"></a>x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb13-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb13-2" aria-hidden="true"></a><span class="kw">hist</span>(x)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-23-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb14-1" aria-hidden="true"></a>x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb14-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb14-2" aria-hidden="true"></a><span class="kw">hist</span>(x)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-24-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb15-1" aria-hidden="true"></a>x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="fl">1e+05</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb15-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb15-2" aria-hidden="true"></a><span class="kw">hist</span>(x)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-25-1.png" width="672" style="display: block; margin: auto;" />
<strong>Comments:</strong></p>
<p><em>R.</em> It cannot be simpler! You use the command <code>hist</code>, feed it a vector of
values, and it produces a histogram. It will even label the axes for you. If you
want to learn how to tweak various features of your histogram, type <code>?hist</code>.</p>
<!-- Esthetically, the built-in histograms leave something to be desired. We can do better, using the package `ggplot2`. You don't have to use it in this class, but if you want to, you install it first by running `install.packages("ggplot2")` (you have to do this only once). Then, every time you want to use it, you run `library(ggplot2)` to notify R that you are about to use a function from that package. It would take a whole semester to learn everything there is to know about `ggplot2`; I will only show what a histogram looks like in it: -->
<!-- ```{r} -->
<!-- library(ggplot2) -->
<!-- x = rnorm(100000, mean = 1, sd = 2) -->
<!-- qplot(x, bins=40) -->
<!-- ``` -->
<p><em>Math</em>. Mathematically, histogram can be produced for any (finite) sequence of
numbers: we divide the range into several bins, count how many of the points in
the sequence falls into each bin, and then draw a bar above that bin whose
height is equal (or proportional to) that count. The picture tells use about how
the sequence we started from is “distributed”. The order of the points does not
matter - you would get exactly the same picture if you sorted the points first.
If the sequence of points you draw the histogram of comes from, say, normal
distribution, the histogram will resemble the shape of the pdf of a normal
distribution. I say resemble, because its shape is ultimately random. If the
number of points is small (like in the second part of this problem) the
histogram may look nothing like the normal pdf. However, when the number of
points gets larger and larger, the shape of the histogram gets closer and closer
to the underlying pdf (if it exists). I keep writing “shape” because the three
histograms above have very different scales on the <span class="math inline">\(y\)</span> axis. That is because we
used counts to set the vertical sizes of bins.
A more natural choice is to use the proportions, i.e. relative frequencies (i.e.
counts divided by the total number of points) for bar heights. More precisely, the bar height <span class="math inline">\(h\)</span> over the bin <span class="math inline">\([a,b]\)</span> is chosen so that the area of the bar, i.e., <span class="math inline">\((b-a)\times h\)</span> equals to the proportion of all points that fall inside <span class="math inline">\([a,b]\)</span>. This way, the total area under the histogram is always <span class="math inline">\(1\)</span>. To draw such a <strong>density histogram</strong> in R we would
need to add the additional option <code>freq = FALSE</code> to <code>hist</code>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb16-1" aria-hidden="true"></a>x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="fl">1e+05</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb16-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb16-2" aria-hidden="true"></a><span class="kw">hist</span>(x, <span class="dt">freq =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-26-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Note how the <span class="math inline">\(y\)</span>-axes label changed from “Frequency” to “Density”.
With such a normalization, the histogram of <span class="math inline">\(x\)</span> can be directly compared to the
probability density of a normal distribution. Here is a histogram of <span class="math inline">\(100,000\)</span>
simulations from our normal distribution with its density function (pdf)
superimposed; I am leaving the code in case you are interested:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb17-1" aria-hidden="true"></a>sims =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10000</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb17-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb17-2" aria-hidden="true"></a>x =<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">6</span>, <span class="dv">8</span>, <span class="dt">by =</span> <span class="fl">0.02</span>)</span>
<span id="cb17-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb17-3" aria-hidden="true"></a>y =<span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb17-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb17-4" aria-hidden="true"></a><span class="kw">hist</span>(sims, <span class="dt">freq =</span> <span class="ot">FALSE</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb17-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb17-5" aria-hidden="true"></a><span class="kw">points</span>(x, y, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-27-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="multivariate-distributions" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Multivariate Distributions</h2>

<div class="exercise">
<p><span id="exr:unnamed-chunk-28" class="exercise"><strong>Problem 2.6  </strong></span>Let <code>x</code> contain <span class="math inline">\(2,000\)</span> draws from <span class="math inline">\(N(0,1)\)</span>, <code>z</code> another <span class="math inline">\(2,000\)</span> draws from <span class="math inline">\(N(0,1)\)</span> and let <code>y=x^2+z</code>.</p>
<ol style="list-style-type: decimal">
<li><p>Draw a scatterplot of <code>x</code> and <code>y</code> to visualize the joint distribution of <code>x</code> and <code>y</code></p></li>
<li><p>Plot two histograms, one of <code>x</code> and one of <code>y</code>. Do they tell the whole story about the joint distribution of <code>x</code> and <code>y</code>?</p></li>
<li><p>Are <code>x</code> and <code>y</code> correlated? Do <code>x</code> and <code>y</code> in your plot “look independent”? Use the permutation test to check of independence between <code>x</code> and <code>y</code>.</p>
</div>
<p><strong>Solution:</strong></p></li>
</ol>
<p>1. </p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb18-1" aria-hidden="true"></a>x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">2000</span>)</span>
<span id="cb18-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb18-2" aria-hidden="true"></a>z =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">2000</span>)</span>
<span id="cb18-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb18-3" aria-hidden="true"></a>y =<span class="st"> </span>x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>z</span>
<span id="cb18-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb18-4" aria-hidden="true"></a><span class="kw">plot</span>(x, y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-29-1.png" width="672" style="display: block; margin: auto;" />
2.  </p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb19-1" aria-hidden="true"></a><span class="kw">hist</span>(x)</span>
<span id="cb19-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb19-2" aria-hidden="true"></a><span class="kw">hist</span>(y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-30-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>No, the two histograms would not be enough to describe the joint distribution.
There are many ways in which two random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> can be jointly
distributed, but whose separate (marginal) distributions match the histograms above. To give a very simple example,
let <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> be discrete random variables, each of which can only take values
<span class="math inline">\(0\)</span> or <span class="math inline">\(1\)</span>. Consider the following two possible <em>joint</em> distribution tables for the random pair <span class="math inline">\((X,Y)\)</span>:</p>
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;text-align: center;">
</th>
<th style="text-align:right;text-align: center;">
0
</th>
<th style="text-align:right;text-align: center;">
1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
0
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
1
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;text-align: center;">
</th>
<th style="text-align:right;text-align: center;">
0
</th>
<th style="text-align:right;text-align: center;">
1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
0
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
1
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>In both cases, the marginals are the same, i.e., both <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are equally likely to take the value <span class="math inline">\(0\)</span> or <span class="math inline">\(1\)</span>, i.e., they both have the Bernoulli distribution with parameter <span class="math inline">\(p=1/2\)</span>. That would correspond to the separate histograms to be the same. On the other hand, their joint distributions (aka dependence structures) are completely different. In the first (left) case, <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent, but in the second they are completely dependent.</p>
<p>3.  They are probably not correlated since the sample correlation between <code>x</code> and <code>y</code> is close to <span class="math inline">\(0\)</span>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb20-1" aria-hidden="true"></a>(<span class="kw">cor</span>(x, y))</span>
<span id="cb20-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb20-2" aria-hidden="true"></a><span class="co">## [1] -0.02880239</span></span></code></pre></div>
<p>but they do not look independent.</p>
<p>To apply the permutation test, we first plot the scatterplot of <code>x</code> vs. <code>y</code> as above. Then, we replace <code>y</code> by a vector with the same components, but randomly permute their positions, and then plot a scatterplot again. We repeat this three times:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb21-1" aria-hidden="true"></a>y_perm_<span class="dv">1</span> =<span class="st"> </span><span class="kw">sample</span>(y)</span>
<span id="cb21-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb21-2" aria-hidden="true"></a>y_perm_<span class="dv">2</span> =<span class="st"> </span><span class="kw">sample</span>(y)</span>
<span id="cb21-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb21-3" aria-hidden="true"></a>y_perm_<span class="dv">3</span> =<span class="st"> </span><span class="kw">sample</span>(y)</span>
<span id="cb21-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb21-4" aria-hidden="true"></a><span class="kw">plot</span>(x, y)</span>
<span id="cb21-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb21-5" aria-hidden="true"></a><span class="kw">plot</span>(x, y_perm_<span class="dv">1</span>)</span>
<span id="cb21-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb21-6" aria-hidden="true"></a><span class="kw">plot</span>(x, y_perm_<span class="dv">2</span>)</span>
<span id="cb21-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb21-7" aria-hidden="true"></a><span class="kw">plot</span>(x, y_perm_<span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The conclusion is clear, the first (upper-left) plot is very different than the other three. Therefore, <code>x</code> and <code>y</code> are probably not independent.</p>
<p><strong>Comments.</strong></p>
<p><em>Math.</em> The point of this problem is to review the notion of the <strong>joint distribution</strong> between two random variables. The most important point here is that there is more to the joint distribution of two random vectors, than just the two distributions taken separately. In a sense, the whole is (much) more than the sum of its parts. This is something that does not happen in the deterministic world. If you give me the <span class="math inline">\(x\)</span>-coordinate of a point, and, separately, its <span class="math inline">\(y\)</span>-coordinate, I will be able to pinpoint the exact location of that point.</p>
<p>On the other hand, suppose that the <span class="math inline">\(x\)</span>-coordinate of a point is unknown, so we treat it as a random variable, and suppose that this variable admits the standard normal distribution. Do the same for <span class="math inline">\(y\)</span>. Even with this information, you cannot say anything about the position of the point <span class="math inline">\((x,y)\)</span>. It could be that the reason we are uncertain about <span class="math inline">\(x\)</span> and the reason we are uncertain about <span class="math inline">\(y\)</span> have nothing to do with each other; in that case we would be right to assume that <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are independent. If, on the other hand, we got the values of both <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> by measuring them using the same, inaccurate, tape measure, we cannot assume that the errors are independent. It is more likely that both <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are too big, or both <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are too small.</p>
<p>Mathematically, we say that random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent if
<span class="math display">\[ {\mathbb{P}}[X \in [a,b]] \times {\mathbb{P}}[ Y \in [c,d] ] = {\mathbb{P}}[ X\in [a,b] \text{ and } Y\in [c,d]]\text{ for all } a,b,c,d.\]</span>
While up to the point, this definition is not very eye-opening, or directly applicable in most cases. Intuitively, <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent if the distribution of <span class="math inline">\(Y\)</span> would not change if we received additional information about <span class="math inline">\(X\)</span>. In our problem, random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> correspond to vectors <code>x</code> and <code>y</code>. Their scatterplot above clearly conveys the following message: when <code>x</code> is around <span class="math inline">\(-2\)</span>, we expect <code>y</code> to be around <code>4</code>, while when <code>x</code> is around <span class="math inline">\(0\)</span>, <code>y</code> would be expected to be around <span class="math inline">\(0\)</span>, too.</p>
<p>Sometimes, it is not so easy to decide whether two variables are independent by staring at a scatterplot. What would you say about the scatterplot below?
<img src="_main_files/figure-html/unnamed-chunk-34-1.png" width="50%" style="display: block; margin: auto;" />
The <strong>permutation test</strong> is designed to help you decide when two (simulated) random variables are likely to be independent. The idea is simple. Suppose that <code>x</code> and <code>y</code> are simulations from two independent (not necessarily identical) distributions; say <code>x=runif(1000)</code> and <code>y=rnorm(1000)</code>. The vector <code>y_perm=sample(y)</code> is a randomly permuted version of <code>y</code> (see R section below) and it contains exactly the same information about the distribution of <code>y</code> as <code>y</code> itself does. Both <code>y</code> and <code>y_perm</code> will produce exactly the same histogram. Permuting <code>y</code>, however, “uncouples” it from <code>x</code>. If there was any dependence between the values of <code>x</code> and <code>y</code> before, there certainly isn’t any now. In other the joint distribution of <code>x</code> and <code>y_perm</code> has the same marginals as the joint distribution of <code>x</code> and <code>y</code>, but all the (possible) dependence has been removed. What remains is to compare the scatterplot between <code>x</code> and <code>y</code> and the scatterplot between <code>x</code> and <code>y_perm</code>. If they look about the same, we conclude that <code>x</code> and <code>y</code> are independent. Otherwise, there is some dependence between them.</p>
<p>One question remains: why did we have to draw three scatterplots of permuted versions of <code>y</code>? That is because we have only finitely many data points, and it can happen, by pure chance, that the permutation we applied to <code>y</code> does not completely scramble its dependence on <code>x</code>. With a “sample” of three such plots, we
get a better feeling for the inherent randomness in this permutation procedure, and it is much easier to tell whether “one of these things is not like the others”. Btw, the random variables in the scatterplot above are, indeed, independent; here are the <span class="math inline">\(4\)</span> permutation-test plots to “prove” it:
<img src="_main_files/figure-html/unnamed-chunk-35-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Unlike univariate (one-variable) distributions which are visualized using histograms or similar plots, multivariate (several-variable) distributions are harder to depict. The most direct relative of the histogram is a <strong>3d histogram</strong>. Just like the <span class="math inline">\(x\)</span>-axis is divided into bins in the univariate case, in the multivariate case we divide the <span class="math inline">\(xy\)</span>-plane into regions (squares, e.g.) and count the number of points falling into each of these regions. After that a 3d bar (a skyscraper) is drawn above each square with the height of each skyscraper equal (or proportional) to the number of points which fall into its base. Here is a 3d histogram of our original pair (<code>x</code>,<code>y</code>) from the problem. You should be able to rotate and zoom it right here in the notes, provided your browser has JavaScript enabled:
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>
        
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="00ed7371-fda6-4780-9f3f-3c6e1448a3ae" class="plotly-graph-div" style="height:700px; width:650px;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("00ed7371-fda6-4780-9f3f-3c6e1448a3ae")) {
                    Plotly.newPlot(
                        '00ed7371-fda6-4780-9f3f-3c6e1448a3ae',
                        [{"color": "#cc5500", "flatshading": true, "i": [256, 274, 256, 273, 256, 259, 273, 274, 258, 275, 259, 273, 288, 306, 288, 305, 288, 291, 305, 306, 290, 307, 291, 305, 320, 334, 320, 333, 320, 323, 333, 334, 322, 335, 323, 333, 344, 354, 344, 353, 344, 347, 353, 354, 346, 355, 347, 353, 168, 198, 168, 197, 168, 171, 197, 198, 170, 199, 171, 197, 224, 242, 224, 241, 224, 227, 241, 242, 226, 243, 227, 241, 260, 278, 260, 277, 260, 263, 277, 278, 262, 279, 263, 277, 292, 310, 292, 309, 292, 295, 309, 310, 294, 311, 295, 309, 32, 54, 32, 53, 32, 35, 53, 54, 34, 55, 35, 53, 72, 98, 72, 97, 72, 75, 97, 98, 74, 99, 75, 97, 120, 146, 120, 145, 120, 123, 145, 146, 122, 147, 123, 145, 172, 202, 172, 201, 172, 175, 201, 202, 174, 203, 175, 201, 228, 246, 228, 245, 228, 231, 245, 246, 230, 247, 231, 245, 0, 18, 0, 17, 0, 3, 17, 18, 2, 19, 3, 17, 36, 58, 36, 57, 36, 39, 57, 58, 38, 59, 39, 57, 76, 102, 76, 101, 76, 79, 101, 102, 78, 103, 79, 101, 124, 150, 124, 149, 124, 127, 149, 150, 126, 151, 127, 149, 176, 206, 176, 205, 176, 179, 205, 206, 178, 207, 179, 205, 4, 22, 4, 21, 4, 7, 21, 22, 6, 23, 7, 21, 40, 62, 40, 61, 40, 43, 61, 62, 42, 63, 43, 61, 80, 106, 80, 105, 80, 83, 105, 106, 82, 107, 83, 105, 128, 154, 128, 153, 128, 131, 153, 154, 130, 155, 131, 153, 8, 26, 8, 25, 8, 11, 25, 26, 10, 27, 11, 25, 44, 66, 44, 65, 44, 47, 65, 66, 46, 67, 47, 65, 84, 110, 84, 109, 84, 87, 109, 110, 86, 111, 87, 109, 132, 158, 132, 157, 132, 135, 157, 158, 134, 159, 135, 157, 180, 210, 180, 209, 180, 183, 209, 210, 182, 211, 183, 209, 12, 30, 12, 29, 12, 15, 29, 30, 14, 31, 15, 29, 48, 70, 48, 69, 48, 51, 69, 70, 50, 71, 51, 69, 88, 114, 88, 113, 88, 91, 113, 114, 90, 115, 91, 113, 136, 162, 136, 161, 136, 139, 161, 162, 138, 163, 139, 161, 184, 214, 184, 213, 184, 187, 213, 214, 186, 215, 187, 213, 92, 118, 92, 117, 92, 95, 117, 118, 94, 119, 95, 117, 140, 166, 140, 165, 140, 143, 165, 166, 142, 167, 143, 165, 188, 218, 188, 217, 188, 191, 217, 218, 190, 219, 191, 217, 232, 250, 232, 249, 232, 235, 249, 250, 234, 251, 235, 249, 264, 282, 264, 281, 264, 267, 281, 282, 266, 283, 267, 281, 192, 222, 192, 221, 192, 195, 221, 222, 194, 223, 195, 221, 236, 254, 236, 253, 236, 239, 253, 254, 238, 255, 239, 253, 268, 286, 268, 285, 268, 271, 285, 286, 270, 287, 271, 285, 296, 314, 296, 313, 296, 299, 313, 314, 298, 315, 299, 313, 324, 338, 324, 337, 324, 327, 337, 338, 326, 339, 327, 337, 300, 318, 300, 317, 300, 303, 317, 318, 302, 319, 303, 317, 328, 342, 328, 341, 328, 331, 341, 342, 330, 343, 331, 341, 348, 358, 348, 357, 348, 351, 357, 358, 350, 359, 351, 357], "j": [272, 258, 257, 272, 258, 257, 272, 275, 259, 274, 257, 275, 304, 290, 289, 304, 290, 289, 304, 307, 291, 306, 289, 307, 332, 322, 321, 332, 322, 321, 332, 335, 323, 334, 321, 335, 352, 346, 345, 352, 346, 345, 352, 355, 347, 354, 345, 355, 196, 170, 169, 196, 170, 169, 196, 199, 171, 198, 169, 199, 240, 226, 225, 240, 226, 225, 240, 243, 227, 242, 225, 243, 276, 262, 261, 276, 262, 261, 276, 279, 263, 278, 261, 279, 308, 294, 293, 308, 294, 293, 308, 311, 295, 310, 293, 311, 52, 34, 33, 52, 34, 33, 52, 55, 35, 54, 33, 55, 96, 74, 73, 96, 74, 73, 96, 99, 75, 98, 73, 99, 144, 122, 121, 144, 122, 121, 144, 147, 123, 146, 121, 147, 200, 174, 173, 200, 174, 173, 200, 203, 175, 202, 173, 203, 244, 230, 229, 244, 230, 229, 244, 247, 231, 246, 229, 247, 16, 2, 1, 16, 2, 1, 16, 19, 3, 18, 1, 19, 56, 38, 37, 56, 38, 37, 56, 59, 39, 58, 37, 59, 100, 78, 77, 100, 78, 77, 100, 103, 79, 102, 77, 103, 148, 126, 125, 148, 126, 125, 148, 151, 127, 150, 125, 151, 204, 178, 177, 204, 178, 177, 204, 207, 179, 206, 177, 207, 20, 6, 5, 20, 6, 5, 20, 23, 7, 22, 5, 23, 60, 42, 41, 60, 42, 41, 60, 63, 43, 62, 41, 63, 104, 82, 81, 104, 82, 81, 104, 107, 83, 106, 81, 107, 152, 130, 129, 152, 130, 129, 152, 155, 131, 154, 129, 155, 24, 10, 9, 24, 10, 9, 24, 27, 11, 26, 9, 27, 64, 46, 45, 64, 46, 45, 64, 67, 47, 66, 45, 67, 108, 86, 85, 108, 86, 85, 108, 111, 87, 110, 85, 111, 156, 134, 133, 156, 134, 133, 156, 159, 135, 158, 133, 159, 208, 182, 181, 208, 182, 181, 208, 211, 183, 210, 181, 211, 28, 14, 13, 28, 14, 13, 28, 31, 15, 30, 13, 31, 68, 50, 49, 68, 50, 49, 68, 71, 51, 70, 49, 71, 112, 90, 89, 112, 90, 89, 112, 115, 91, 114, 89, 115, 160, 138, 137, 160, 138, 137, 160, 163, 139, 162, 137, 163, 212, 186, 185, 212, 186, 185, 212, 215, 187, 214, 185, 215, 116, 94, 93, 116, 94, 93, 116, 119, 95, 118, 93, 119, 164, 142, 141, 164, 142, 141, 164, 167, 143, 166, 141, 167, 216, 190, 189, 216, 190, 189, 216, 219, 191, 218, 189, 219, 248, 234, 233, 248, 234, 233, 248, 251, 235, 250, 233, 251, 280, 266, 265, 280, 266, 265, 280, 283, 267, 282, 265, 283, 220, 194, 193, 220, 194, 193, 220, 223, 195, 222, 193, 223, 252, 238, 237, 252, 238, 237, 252, 255, 239, 254, 237, 255, 284, 270, 269, 284, 270, 269, 284, 287, 271, 286, 269, 287, 312, 298, 297, 312, 298, 297, 312, 315, 299, 314, 297, 315, 336, 326, 325, 336, 326, 325, 336, 339, 327, 338, 325, 339, 316, 302, 301, 316, 302, 301, 316, 319, 303, 318, 301, 319, 340, 330, 329, 340, 330, 329, 340, 343, 331, 342, 329, 343, 356, 350, 349, 356, 350, 349, 356, 359, 351, 358, 349, 359], "k": [274, 256, 273, 256, 259, 256, 274, 273, 275, 258, 273, 259, 306, 288, 305, 288, 291, 288, 306, 305, 307, 290, 305, 291, 334, 320, 333, 320, 323, 320, 334, 333, 335, 322, 333, 323, 354, 344, 353, 344, 347, 344, 354, 353, 355, 346, 353, 347, 198, 168, 197, 168, 171, 168, 198, 197, 199, 170, 197, 171, 242, 224, 241, 224, 227, 224, 242, 241, 243, 226, 241, 227, 278, 260, 277, 260, 263, 260, 278, 277, 279, 262, 277, 263, 310, 292, 309, 292, 295, 292, 310, 309, 311, 294, 309, 295, 54, 32, 53, 32, 35, 32, 54, 53, 55, 34, 53, 35, 98, 72, 97, 72, 75, 72, 98, 97, 99, 74, 97, 75, 146, 120, 145, 120, 123, 120, 146, 145, 147, 122, 145, 123, 202, 172, 201, 172, 175, 172, 202, 201, 203, 174, 201, 175, 246, 228, 245, 228, 231, 228, 246, 245, 247, 230, 245, 231, 18, 0, 17, 0, 3, 0, 18, 17, 19, 2, 17, 3, 58, 36, 57, 36, 39, 36, 58, 57, 59, 38, 57, 39, 102, 76, 101, 76, 79, 76, 102, 101, 103, 78, 101, 79, 150, 124, 149, 124, 127, 124, 150, 149, 151, 126, 149, 127, 206, 176, 205, 176, 179, 176, 206, 205, 207, 178, 205, 179, 22, 4, 21, 4, 7, 4, 22, 21, 23, 6, 21, 7, 62, 40, 61, 40, 43, 40, 62, 61, 63, 42, 61, 43, 106, 80, 105, 80, 83, 80, 106, 105, 107, 82, 105, 83, 154, 128, 153, 128, 131, 128, 154, 153, 155, 130, 153, 131, 26, 8, 25, 8, 11, 8, 26, 25, 27, 10, 25, 11, 66, 44, 65, 44, 47, 44, 66, 65, 67, 46, 65, 47, 110, 84, 109, 84, 87, 84, 110, 109, 111, 86, 109, 87, 158, 132, 157, 132, 135, 132, 158, 157, 159, 134, 157, 135, 210, 180, 209, 180, 183, 180, 210, 209, 211, 182, 209, 183, 30, 12, 29, 12, 15, 12, 30, 29, 31, 14, 29, 15, 70, 48, 69, 48, 51, 48, 70, 69, 71, 50, 69, 51, 114, 88, 113, 88, 91, 88, 114, 113, 115, 90, 113, 91, 162, 136, 161, 136, 139, 136, 162, 161, 163, 138, 161, 139, 214, 184, 213, 184, 187, 184, 214, 213, 215, 186, 213, 187, 118, 92, 117, 92, 95, 92, 118, 117, 119, 94, 117, 95, 166, 140, 165, 140, 143, 140, 166, 165, 167, 142, 165, 143, 218, 188, 217, 188, 191, 188, 218, 217, 219, 190, 217, 191, 250, 232, 249, 232, 235, 232, 250, 249, 251, 234, 249, 235, 282, 264, 281, 264, 267, 264, 282, 281, 283, 266, 281, 267, 222, 192, 221, 192, 195, 192, 222, 221, 223, 194, 221, 195, 254, 236, 253, 236, 239, 236, 254, 253, 255, 238, 253, 239, 286, 268, 285, 268, 271, 268, 286, 285, 287, 270, 285, 271, 314, 296, 313, 296, 299, 296, 314, 313, 315, 298, 313, 299, 338, 324, 337, 324, 327, 324, 338, 337, 339, 326, 337, 327, 318, 300, 317, 300, 303, 300, 318, 317, 319, 302, 317, 303, 342, 328, 341, 328, 331, 328, 342, 341, 343, 330, 341, 331, 358, 348, 357, 348, 351, 348, 358, 357, 359, 350, 357, 351], "opacity": 1, "type": "mesh3d", "x": [-4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.486428005685525, 2.486428005685525, 2.486428005685525, 2.486428005685525, 2.486428005685525, 2.486428005685525, 2.486428005685525, 2.486428005685525, 2.486428005685525, 2.486428005685525, 2.486428005685525, 2.486428005685525, 3.249271589919543, 3.249271589919543, 3.249271589919543, 3.249271589919543, 3.249271589919543, 3.249271589919543, 3.249271589919543, 3.249271589919543, 3.249271589919543, 3.249271589919543, 3.249271589919543, 3.249271589919543, 3.2992715899195426, 3.2992715899195426, 3.2992715899195426, 3.2992715899195426, 3.2992715899195426, 3.2992715899195426, 3.2992715899195426, 3.2992715899195426, 4.06211517415356, 4.06211517415356, 4.06211517415356, 4.06211517415356, 4.06211517415356, 4.06211517415356, 4.06211517415356, 4.06211517415356], "y": [1.9855429763209842, 1.9855429763209842, 3.8049731900120003, 3.8049731900120003, 3.8549731900120006, 3.8549731900120006, 5.674403403703017, 5.674403403703017, 5.7244034037030165, 5.7244034037030165, 7.543833617394033, 7.543833617394033, 7.593833617394033, 7.593833617394033, 9.413263831085048, 9.413263831085048, 1.9855429763209842, 1.9855429763209842, 3.8049731900120003, 3.8049731900120003, 3.8549731900120006, 3.8549731900120006, 5.674403403703017, 5.674403403703017, 5.7244034037030165, 5.7244034037030165, 7.543833617394033, 7.543833617394033, 7.593833617394033, 7.593833617394033, 9.413263831085048, 9.413263831085048, 0.11611276262996784, 0.11611276262996784, 1.9355429763209842, 1.9355429763209842, 1.9855429763209842, 1.9855429763209842, 3.8049731900120003, 3.8049731900120003, 3.8549731900120006, 3.8549731900120006, 5.674403403703017, 5.674403403703017, 5.7244034037030165, 5.7244034037030165, 7.543833617394033, 7.543833617394033, 7.593833617394033, 7.593833617394033, 9.413263831085048, 9.413263831085048, 0.11611276262996784, 0.11611276262996784, 1.9355429763209842, 1.9355429763209842, 1.9855429763209842, 1.9855429763209842, 3.8049731900120003, 3.8049731900120003, 3.8549731900120006, 3.8549731900120006, 5.674403403703017, 5.674403403703017, 5.7244034037030165, 5.7244034037030165, 7.543833617394033, 7.543833617394033, 7.593833617394033, 7.593833617394033, 9.413263831085048, 9.413263831085048, 0.11611276262996784, 0.11611276262996784, 1.9355429763209842, 1.9355429763209842, 1.9855429763209842, 1.9855429763209842, 3.8049731900120003, 3.8049731900120003, 3.8549731900120006, 3.8549731900120006, 5.674403403703017, 5.674403403703017, 5.7244034037030165, 5.7244034037030165, 7.543833617394033, 7.543833617394033, 7.593833617394033, 7.593833617394033, 9.413263831085048, 9.413263831085048, 9.46326383108505, 9.46326383108505, 11.282694044776065, 11.282694044776065, 0.11611276262996784, 0.11611276262996784, 1.9355429763209842, 1.9355429763209842, 1.9855429763209842, 1.9855429763209842, 3.8049731900120003, 3.8049731900120003, 3.8549731900120006, 3.8549731900120006, 5.674403403703017, 5.674403403703017, 5.7244034037030165, 5.7244034037030165, 7.543833617394033, 7.543833617394033, 7.593833617394033, 7.593833617394033, 9.413263831085048, 9.413263831085048, 9.46326383108505, 9.46326383108505, 11.282694044776065, 11.282694044776065, 0.11611276262996784, 0.11611276262996784, 1.9355429763209842, 1.9355429763209842, 1.9855429763209842, 1.9855429763209842, 3.8049731900120003, 3.8049731900120003, 3.8549731900120006, 3.8549731900120006, 5.674403403703017, 5.674403403703017, 5.7244034037030165, 5.7244034037030165, 7.543833617394033, 7.543833617394033, 7.593833617394033, 7.593833617394033, 9.413263831085048, 9.413263831085048, 9.46326383108505, 9.46326383108505, 11.282694044776065, 11.282694044776065, 0.11611276262996784, 0.11611276262996784, 1.9355429763209842, 1.9355429763209842, 1.9855429763209842, 1.9855429763209842, 3.8049731900120003, 3.8049731900120003, 3.8549731900120006, 3.8549731900120006, 5.674403403703017, 5.674403403703017, 5.7244034037030165, 5.7244034037030165, 7.543833617394033, 7.543833617394033, 7.593833617394033, 7.593833617394033, 9.413263831085048, 9.413263831085048, 9.46326383108505, 9.46326383108505, 11.282694044776065, 11.282694044776065, -1.7533174510610485, -1.7533174510610485, 0.06611276262996779, 0.06611276262996779, 0.11611276262996784, 0.11611276262996784, 1.9355429763209842, 1.9355429763209842, 1.9855429763209842, 1.9855429763209842, 3.8049731900120003, 3.8049731900120003, 5.7244034037030165, 5.7244034037030165, 7.543833617394033, 7.543833617394033, 7.593833617394033, 7.593833617394033, 9.413263831085048, 9.413263831085048, 9.46326383108505, 9.46326383108505, 11.282694044776065, 11.282694044776065, 11.332694044776066, 11.332694044776066, 13.152124258467081, 13.152124258467081, -1.7533174510610485, -1.7533174510610485, 0.06611276262996779, 0.06611276262996779, 0.11611276262996784, 0.11611276262996784, 1.9355429763209842, 1.9355429763209842, 1.9855429763209842, 1.9855429763209842, 3.8049731900120003, 3.8049731900120003, 5.7244034037030165, 5.7244034037030165, 7.543833617394033, 7.543833617394033, 7.593833617394033, 7.593833617394033, 9.413263831085048, 9.413263831085048, 9.46326383108505, 9.46326383108505, 11.282694044776065, 11.282694044776065, 11.332694044776066, 11.332694044776066, 13.152124258467081, 13.152124258467081, -1.7533174510610485, -1.7533174510610485, 0.06611276262996779, 0.06611276262996779, 0.11611276262996784, 0.11611276262996784, 1.9355429763209842, 1.9355429763209842, 9.46326383108505, 9.46326383108505, 11.282694044776065, 11.282694044776065, 11.332694044776066, 11.332694044776066, 13.152124258467081, 13.152124258467081, -1.7533174510610485, -1.7533174510610485, 0.06611276262996779, 0.06611276262996779, 0.11611276262996784, 0.11611276262996784, 1.9355429763209842, 1.9355429763209842, 9.46326383108505, 9.46326383108505, 11.282694044776065, 11.282694044776065, 11.332694044776066, 11.332694044776066, 13.152124258467081, 13.152124258467081, -3.622747664752065, -3.622747664752065, -1.8033174510610486, -1.8033174510610486, -1.7533174510610485, -1.7533174510610485, 0.06611276262996779, 0.06611276262996779, 9.46326383108505, 9.46326383108505, 11.282694044776065, 11.282694044776065, 11.332694044776066, 11.332694044776066, 13.152124258467081, 13.152124258467081, -3.622747664752065, -3.622747664752065, -1.8033174510610486, -1.8033174510610486, -1.7533174510610485, -1.7533174510610485, 0.06611276262996779, 0.06611276262996779, 9.46326383108505, 9.46326383108505, 11.282694044776065, 11.282694044776065, 11.332694044776066, 11.332694044776066, 13.152124258467081, 13.152124258467081, -3.622747664752065, -3.622747664752065, -1.8033174510610486, -1.8033174510610486, -1.7533174510610485, -1.7533174510610485, 0.06611276262996779, 0.06611276262996779, 11.332694044776066, 11.332694044776066, 13.152124258467081, 13.152124258467081, 13.202124258467084, 13.202124258467084, 15.0215544721581, 15.0215544721581, -3.622747664752065, -3.622747664752065, -1.8033174510610486, -1.8033174510610486, -1.7533174510610485, -1.7533174510610485, 0.06611276262996779, 0.06611276262996779, 11.332694044776066, 11.332694044776066, 13.152124258467081, 13.152124258467081, 13.202124258467084, 13.202124258467084, 15.0215544721581, 15.0215544721581, -3.622747664752065, -3.622747664752065, -1.8033174510610486, -1.8033174510610486, 11.332694044776066, 11.332694044776066, 13.152124258467081, 13.152124258467081, 13.202124258467084, 13.202124258467084, 15.0215544721581, 15.0215544721581, -3.622747664752065, -3.622747664752065, -1.8033174510610486, -1.8033174510610486, 11.332694044776066, 11.332694044776066, 13.152124258467081, 13.152124258467081, 13.202124258467084, 13.202124258467084, 15.0215544721581, 15.0215544721581, -3.622747664752065, -3.622747664752065, -1.8033174510610486, -1.8033174510610486, 13.202124258467084, 13.202124258467084, 15.0215544721581, 15.0215544721581, -3.622747664752065, -3.622747664752065, -1.8033174510610486, -1.8033174510610486, 13.202124258467084, 13.202124258467084, 15.0215544721581, 15.0215544721581], "z": [0.0, 4.0, 0.0, 4.0, 0.0, 84.0, 0.0, 84.0, 0.0, 81.0, 0.0, 81.0, 0.0, 2.0, 0.0, 2.0, 0.0, 4.0, 0.0, 4.0, 0.0, 84.0, 0.0, 84.0, 0.0, 81.0, 0.0, 81.0, 0.0, 2.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 0.0, 266.0, 0.0, 266.0, 0.0, 1201.0, 0.0, 1201.0, 0.0, 1204.0, 0.0, 1204.0, 0.0, 170.0, 0.0, 170.0, 0.0, 1.0, 0.0, 1.0, 0.0, 266.0, 0.0, 266.0, 0.0, 1201.0, 0.0, 1201.0, 0.0, 1204.0, 0.0, 1204.0, 0.0, 170.0, 0.0, 170.0, 0.0, 50.0, 0.0, 50.0, 0.0, 998.0, 0.0, 998.0, 0.0, 1429.0, 0.0, 1429.0, 0.0, 1481.0, 0.0, 1481.0, 0.0, 817.0, 0.0, 817.0, 0.0, 28.0, 0.0, 28.0, 0.0, 50.0, 0.0, 50.0, 0.0, 998.0, 0.0, 998.0, 0.0, 1429.0, 0.0, 1429.0, 0.0, 1481.0, 0.0, 1481.0, 0.0, 817.0, 0.0, 817.0, 0.0, 28.0, 0.0, 28.0, 0.0, 234.0, 0.0, 234.0, 0.0, 449.0, 0.0, 449.0, 0.0, 107.0, 0.0, 107.0, 0.0, 128.0, 0.0, 128.0, 0.0, 459.0, 0.0, 459.0, 0.0, 188.0, 0.0, 188.0, 0.0, 234.0, 0.0, 234.0, 0.0, 449.0, 0.0, 449.0, 0.0, 107.0, 0.0, 107.0, 0.0, 128.0, 0.0, 128.0, 0.0, 459.0, 0.0, 459.0, 0.0, 188.0, 0.0, 188.0, 0.0, 22.0, 0.0, 22.0, 0.0, 189.0, 0.0, 189.0, 0.0, 15.0, 0.0, 15.0, 0.0, 1.0, 0.0, 1.0, 0.0, 26.0, 0.0, 26.0, 0.0, 175.0, 0.0, 175.0, 0.0, 4.0, 0.0, 4.0, 0.0, 22.0, 0.0, 22.0, 0.0, 189.0, 0.0, 189.0, 0.0, 15.0, 0.0, 15.0, 0.0, 1.0, 0.0, 1.0, 0.0, 26.0, 0.0, 26.0, 0.0, 175.0, 0.0, 175.0, 0.0, 4.0, 0.0, 4.0, 0.0, 33.0, 0.0, 33.0, 0.0, 31.0, 0.0, 31.0, 0.0, 34.0, 0.0, 34.0, 0.0, 22.0, 0.0, 22.0, 0.0, 33.0, 0.0, 33.0, 0.0, 31.0, 0.0, 31.0, 0.0, 34.0, 0.0, 34.0, 0.0, 22.0, 0.0, 22.0, 0.0, 1.0, 0.0, 1.0, 0.0, 18.0, 0.0, 18.0, 0.0, 1.0, 0.0, 1.0, 0.0, 21.0, 0.0, 21.0, 0.0, 1.0, 0.0, 1.0, 0.0, 18.0, 0.0, 18.0, 0.0, 1.0, 0.0, 1.0, 0.0, 21.0, 0.0, 21.0, 0.0, 1.0, 0.0, 1.0, 0.0, 5.0, 0.0, 5.0, 0.0, 6.0, 0.0, 6.0, 0.0, 3.0, 0.0, 3.0, 0.0, 1.0, 0.0, 1.0, 0.0, 5.0, 0.0, 5.0, 0.0, 6.0, 0.0, 6.0, 0.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 0.0, 2.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0]}],
                        {"height": 700, "hovermode": false, "scene": {"camera": {"eye": {"x": -1.25, "y": 1.25, "z": 1.25}}}, "showlegend": false, "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "title": {"x": 0.5}, "width": 650},
                        {"displayModeBar": false, "responsive": true}
                    )
                };
                
            </script>
        </div>
</body>
</html></p>
<p>A visualization solution that requires less technology would start the same way, i.e., by dividing the <span class="math inline">\(xy\)</span> plane into regions, but instead of the third dimension, it would use different colors to represent the counts. Here is an example where the regions are hexagons, as opposed to squares; it just looks better, for some reason:</p>
<p><img src="_main_files/figure-html/unnamed-chunk-37-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Just to showcase the range of possibilities, here is another visualization technique which which requires deeper statistical tools, namely the <strong>density contour plot</strong>:
<img src="_main_files/figure-html/unnamed-chunk-38-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><em>R.</em> There is very little new R here.
You should remember that if <code>x</code> and <code>y</code> are vectors of the same length, <code>plot(x,y)</code> gives you a scatterplot of <code>x</code> and <code>y</code>.</p>
<p>To compute the sample correlation between two vectors, use the <code>cor</code>.</p>
<p>We used the command <code>sample(y)</code> to obtain a randomly permuted version of <code>y</code>. The simplicity of this is due to default parameters of the command <code>sample</code> which we already learned about. In particular, the default number of samples is exactly the size of the input vector <code>y</code> and, by default, sampling is performed <em>without replacement</em>. If you think about it for a second, you will realize that a sample of size <span class="math inline">\(n\)</span> from the vector of size <span class="math inline">\(n\)</span> <em>without</em> replacement is nothing by a random permutation of <code>y</code>.</p>
<p>You are not required to do this in your submissions, but if you want to display several plots side-by-side, use the command is <code>par(mfrow=c(m,n))</code> before the <code>plot</code> commands. It tells R to plot the next <span class="math inline">\(mn\)</span> plots in a <span class="math inline">\(m\times n\)</span> grid.</p>

<div class="exercise">
<span id="exr:unnamed-chunk-39" class="exercise"><strong>Problem 2.7  </strong></span>Random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> have the joint distribution given by the following table:
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;text-align: center;">
</th>
<th style="text-align:right;text-align: center;">
1
</th>
<th style="text-align:right;text-align: center;">
2
</th>
<th style="text-align:right;text-align: center;">
3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
1
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.3
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
2
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
</tbody>
</table>
Simulate <span class="math inline">\(10,000\)</span> draws from the distribution of <span class="math inline">\((X,Y)\)</span> and display a frequency table
of your results.
</div>
</div>
<div id="additional-problems" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Additional Problems</h2>

<div class="exercise">
<p><span id="exr:unnamed-chunk-40" class="exercise"><strong>Problem 2.8  </strong></span><br></p>
<ol style="list-style-type: decimal">
<li><p>Find the Weibull distribution in R’s help system.<!-- ' -->
Simulate <span class="math inline">\(n=10000\)</span> draws from the Weibull distribution with shape parameter <span class="math inline">\(2\)</span> and scale parameter <span class="math inline">\(3\)</span>. Draw a histogram of your simulations.</p></li>
<li><p>Suppose that the vector <code>x</code> contains <span class="math inline">\(n=10000\)</span> simulations from the standard
normal <span class="math inline">\(\mu=0, \sigma=1)\)</span>. Without simulating any new random numbers,
transform it into the vector <code>y</code> such that <code>y</code> is a vector of <span class="math inline">\(n=10000\)</span>
simulations from the normal with <span class="math inline">\(\mu=1\)</span> and <span class="math inline">\(\sigma=0.5\)</span>. Draw histograms
of both <code>x</code> and <code>y</code> on the same plot. (<em>Note:</em> the extra parameter <code>add</code> is
used to superimpose plots. You may want to use different colors, too. Use
the e parameter <code>col</code> for that. )</p></li>
<li><p>Starting with <code>x=seq(-3,3,by=0.1)</code>, define the appropriate vector <code>y</code> and
use <code>x</code> and <code>y</code> to plot the graph of the cdf of the standard normal. The
command you want to use is <code>plot</code> with the following extra arguments</p></li>
</ol>
<ul>
<li><code>type="l"</code> (to get a smooth line instead of a bunch of points).</li>
<li><code>main="The CDF of the standard normal"</code> (to set the title), and</li>
<li>another argument (which you must look up youself) that will set the <span class="math inline">\(y\)</span>-axis label to <span class="math inline">\(F(x)\)</span>.
</div></li>
</ul>

<div class="exercise">
<p><span id="exr:unnamed-chunk-41" class="exercise"><strong>Problem 2.9  </strong></span><br></p>
<ol style="list-style-type: decimal">
<li><p>Simulate <span class="math inline">\(n=1000\)</span> draws from the distribution whose distribution table is given by</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
<p>2</p>
</th>
<th style="text-align:right;">
<p>4</p>
</th>
<th style="text-align:right;">
<p>8</p>
</th>
<th style="text-align:right;">
<p>16</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
<p>0.2</p>
</td>
<td style="text-align:right;">
<p>0.3</p>
</td>
<td style="text-align:right;">
<p>0.1</p>
</td>
<td style="text-align:right;">
<p>0.4</p>
</td>
</tr>
</tbody>
</table>
<p>and plot their histogram.</p></li>
<li><p>You may have learned in probability how to compute the pdf <span class="math inline">\(f_Y(y)\)</span> of a
transformation <span class="math inline">\(Y=g(X)\)</span> of a random variable with pdf <span class="math inline">\(f_X(x)\)</span>. Suppose
that you forgot how to do that, but have access to <span class="math inline">\(10,000\)</span> simulations from
the distribution of <span class="math inline">\(X\)</span>. How would you get an approximate idea about the
shape of the function <span class="math inline">\(f_Y\)</span>? <br>
More concretely, take <span class="math inline">\(X\)</span> to be exponentially distributed with parameter <span class="math inline">\(1\)</span> and
<span class="math inline">\(g(x) = \sin(x)\)</span> and produce a picture that approximates the pdf <span class="math inline">\(f_Y\)</span> of <span class="math inline">\(Y\)</span>.
(Note: even if you remember how to do this analytically, you will run into a
difficulty. The function <span class="math inline">\(\sin(x)\)</span> is not one-to-one and the method usually
taught in probability classes will not apply. If you learned how to do it in the
many-to-one case of <span class="math inline">\(g(x)= \sin(x)\)</span>, kudos to your instructor!)</p></li>
<li><p>Let <span class="math inline">\(X\)</span> be a random variable with the Cauchy distribution, and <span class="math inline">\(Y = \operatorname{arctan}(X)\)</span>. R allows you to simulate from the Cauchy
distribution, even if you do not know what it is. How would you use that to
make an educated guess as to what the distribution of <span class="math inline">\(Y\)</span> is? To make your
life easier, consider <span class="math inline">\(\tfrac{2}{\pi} Y\)</span> first.</p></li>
</ol>
</div>

<div class="exercise">
<span id="exr:unnamed-chunk-42" class="exercise"><strong>Problem 2.10  </strong></span>A basic method for obtaining simulations draws from distributions other than the
uniform is the <strong>transformation method</strong>. The idea is to start with (pseudo)
random numbers, i.e., draws from the uniform <span class="math inline">\(U(0,1)\)</span> distribution, and then
apply a function <span class="math inline">\(g\)</span> to each simulation. The difficulty is, of course, how to
choose the right function <span class="math inline">\(g\)</span>.
<br>
Let <span class="math inline">\(X\)</span> be a random variable with a continuous and strictly increasing cdf <span class="math inline">\(F\)</span>.
What is the distribution of <span class="math inline">\(Y=F(X)\)</span>? What does that have to do with the transformation method?
</div>

<div class="exercise">
<p><span id="exr:unnamed-chunk-43" class="exercise"><strong>Problem 2.11  </strong></span>(Extra credit)</p>
<ol style="list-style-type: decimal">
<li><p>Let <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> be two pdfs. We take a constant <span class="math inline">\(\alpha \in (0,1)\)</span> and define the function <span class="math inline">\(f\)</span> by
<span class="math display">\[ f(x) = \alpha f_1(x) + (1-\alpha) f_2(x).\]</span>
The function <span class="math inline">\(f\)</span> is the pdf of a third distribution, which is called the
<strong>mixture of <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> with weights <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(1-\alpha\)</span></strong>.
Assuming that you know how to simulate from the distributions with pdfs <span class="math inline">\(f_1\)</span>
and <span class="math inline">\(f_2\)</span>, how would you draw <span class="math inline">\(10,000\)</span> simulations from the mixture <span class="math inline">\(f\)</span>? Show
your method on the example of a mixture of <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(4,1)\)</span> with
<span class="math inline">\(\alpha=2/3\)</span>. Plot the histogram of the obtained sample (play with the
parameter <code>breaks</code> until you get a nice picture.)</p>
<p>(<em>Hint:</em> start with two vectors, the first containing <span class="math inline">\(10,000\)</span> simulations from
<span class="math inline">\(f_1\)</span> and the second from <span class="math inline">\(f_2\)</span>. Then “toss” <span class="math inline">\(10,000\)</span> biased coins with
<span class="math inline">\(\mathbb{P}[ H ] = \alpha\)</span> … )</p></li>
<li><p>The <strong>double exponential</strong> or
<strong>Laplace</strong> distribution is a continuous probability distribution whose pdf is
given by <span class="math display">\[ \tfrac{1}{2} \exp(-|x|), x\in {\mathbb R}.\]</span> This distribution
is not built into R. How would you produce simulations from the double
exponential using R?</p>
</div></li>
</ol>
<p>⬇︎ In case you were wondering, the text below belongs to footnotes from somewhere high above.⬇︎</p>

</div>
</div>



<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>There are infinitely many ways random variables can be
distributed. Indeed, in the discrete <span class="math inline">\({\mathbb N}\)</span>-valued case only, any
sequence of nonnegative numbers <span class="math inline">\((p_n)_n\)</span> such that <span class="math inline">\(\sum_n p_n=1\)</span> defines
<em>a</em> probability distribution. It turns out, however, that a small-ish number of
distributions appear in nature much more often then the rest. These
distributions, like the normal, uniform, exponential, binomial, etc. turn out to
be so important that they each get a name (hence <em>named distributions</em>). <a href="simulation-of-random-variables-and-monte-carlo.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Some books will define the geometric random variables as the number of <em>tosses</em> (and not Ts) before the first H is obtained. In that case, the final H is included into the count. Clearly, this definition and the one we have given differ by <span class="math inline">\(1\)</span>, and this is really not a big deal, but you have to be careful about what is meant when a geometric random variable is mentioned.<a href="simulation-of-random-variables-and-monte-carlo.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>The function <code>sum</code> adds up all the components of the vector.
You would not want such a function to be vectorized. If it were, it would return
exactly the same vector it got as input.<a href="simulation-of-random-variables-and-monte-carlo.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dist.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": false,
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
